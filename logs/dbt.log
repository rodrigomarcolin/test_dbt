

============================== 2022-08-03 17:15:16.345372 | dca57294-acf1-4473-9021-021aa8c41dae ==============================
[0m17:15:16.345383 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:15:16.345720 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:15:16.345862 [debug] [MainThread]: Tracking: do not track
[0m17:15:16.364247 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m17:15:16.400368 [debug] [MainThread]: Parsing macros/relations.sql
[0m17:15:16.405817 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:15:16.407930 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:15:16.442471 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m17:15:16.443886 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:15:16.449814 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:15:16.451020 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:15:16.451454 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:15:16.452471 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:15:16.453868 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:15:16.455263 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m17:15:16.459120 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m17:15:16.467327 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m17:15:16.475807 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m17:15:16.477691 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:15:16.489560 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m17:15:16.498736 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m17:15:16.501475 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m17:15:16.504338 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m17:15:16.508768 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m17:15:16.523751 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m17:15:16.525861 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m17:15:16.529291 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m17:15:16.544761 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m17:15:16.551271 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m17:15:16.552860 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m17:15:16.569537 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m17:15:16.582131 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m17:15:16.592851 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m17:15:16.597302 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m17:15:16.601044 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m17:15:16.605414 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m17:15:16.618773 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m17:15:16.635523 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m17:15:16.637180 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m17:15:16.646453 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m17:15:16.648487 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m17:15:16.651646 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m17:15:16.656271 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m17:15:16.657669 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m17:15:16.661612 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m17:15:16.663358 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m17:15:16.664915 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m17:15:16.665523 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m17:15:16.666237 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m17:15:16.666950 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m17:15:16.668134 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m17:15:16.669832 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m17:15:16.671383 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m17:15:16.673685 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:15:16.675323 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:15:16.676960 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:15:16.677934 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:15:16.678937 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:15:16.679754 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m17:15:16.684983 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:15:16.686272 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m17:15:16.687144 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:15:16.687875 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:15:16.688683 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:15:16.689587 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:15:16.690509 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:15:16.691914 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:15:16.693613 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:15:16.696810 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m17:15:16.698822 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:15:16.700228 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:15:16.702467 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:15:16.703390 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m17:15:16.704727 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:15:16.706714 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m17:15:16.944384 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:15:16.957363 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m17:15:17.031635 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:15:17.033552 [info ] [MainThread]: 
[0m17:15:17.034265 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:15:17.035829 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid"
[0m17:15:17.045458 [debug] [ThreadPool]: Using postgres connection "list_covid"
[0m17:15:17.046006 [debug] [ThreadPool]: On list_covid: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "list_covid"} */

    select distinct nspname from pg_namespace
  
[0m17:15:17.046248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:17.141575 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.1 seconds
[0m17:15:17.143903 [debug] [ThreadPool]: On list_covid: Close
[0m17:15:17.145512 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid_public"
[0m17:15:17.154596 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:15:17.154925 [debug] [ThreadPool]: On list_covid_public: BEGIN
[0m17:15:17.155243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:17.161326 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:15:17.162331 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:15:17.162752 [debug] [ThreadPool]: On list_covid_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "list_covid_public"} */
select
      'covid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'covid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:15:17.187418 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.02 seconds
[0m17:15:17.188528 [debug] [ThreadPool]: On list_covid_public: ROLLBACK
[0m17:15:17.188796 [debug] [ThreadPool]: On list_covid_public: Close
[0m17:15:17.192981 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:17.193195 [debug] [MainThread]: On master: BEGIN
[0m17:15:17.193321 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:17.195823 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:15:17.196114 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:17.196329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:17.211341 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m17:15:17.212614 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:17.213033 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:17.213269 [debug] [MainThread]: On master: BEGIN
[0m17:15:17.213764 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:15:17.213933 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.214061 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:17.214206 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.214512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:15:17.214672 [debug] [MainThread]: On master: Close
[0m17:15:17.214998 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m17:15:17.215269 [info ] [MainThread]: 
[0m17:15:17.224374 [debug] [Thread-1 (]: Began running node model.postgres_test.my_first_dbt_model
[0m17:15:17.225418 [info ] [Thread-1 (]: 1 of 2 START table model public.my_first_dbt_model ..................................................................... [RUN]
[0m17:15:17.226944 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:15:17.227343 [debug] [Thread-1 (]: Began compiling node model.postgres_test.my_first_dbt_model
[0m17:15:17.227523 [debug] [Thread-1 (]: Compiling model.postgres_test.my_first_dbt_model
[0m17:15:17.230654 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.my_first_dbt_model"
[0m17:15:17.231482 [debug] [Thread-1 (]: finished collecting timing info
[0m17:15:17.231727 [debug] [Thread-1 (]: Began executing node model.postgres_test.my_first_dbt_model
[0m17:15:17.269645 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.my_first_dbt_model"
[0m17:15:17.270051 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:15:17.270189 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: BEGIN
[0m17:15:17.270310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:17.272853 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:17.273156 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:15:17.273296 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */


  create  table "covid"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:15:17.292782 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.02 seconds
[0m17:15:17.302980 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:15:17.303398 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */
alter table "covid"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:15:17.304620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:17.326259 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: COMMIT
[0m17:15:17.326466 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:15:17.326600 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: COMMIT
[0m17:15:17.327268 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:15:17.332544 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:15:17.333099 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */
drop table if exists "covid"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:15:17.333436 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:15:17.334492 [debug] [Thread-1 (]: finished collecting timing info
[0m17:15:17.334719 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: Close
[0m17:15:17.335340 [info ] [Thread-1 (]: 1 of 2 OK created table model public.my_first_dbt_model ................................................................ [[32mSELECT 2[0m in 0.11s]
[0m17:15:17.335815 [debug] [Thread-1 (]: Finished running node model.postgres_test.my_first_dbt_model
[0m17:15:17.336492 [debug] [Thread-3 (]: Began running node model.postgres_test.my_second_dbt_model
[0m17:15:17.336771 [info ] [Thread-3 (]: 2 of 2 START view model public.my_second_dbt_model ..................................................................... [RUN]
[0m17:15:17.337193 [debug] [Thread-3 (]: Acquiring new postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:15:17.337333 [debug] [Thread-3 (]: Began compiling node model.postgres_test.my_second_dbt_model
[0m17:15:17.337466 [debug] [Thread-3 (]: Compiling model.postgres_test.my_second_dbt_model
[0m17:15:17.340182 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_test.my_second_dbt_model"
[0m17:15:17.340438 [debug] [Thread-3 (]: finished collecting timing info
[0m17:15:17.340582 [debug] [Thread-3 (]: Began executing node model.postgres_test.my_second_dbt_model
[0m17:15:17.362923 [debug] [Thread-3 (]: Writing runtime SQL for node "model.postgres_test.my_second_dbt_model"
[0m17:15:17.363311 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:15:17.363450 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: BEGIN
[0m17:15:17.363573 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:15:17.367787 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:17.368236 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:15:17.368383 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_second_dbt_model"} */

  create view "covid"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "covid"."public"."my_first_dbt_model"
where id = 1
  );
[0m17:15:17.372088 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:15:17.375064 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:15:17.375541 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_second_dbt_model"} */
alter table "covid"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:15:17.376611 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:17.378680 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: COMMIT
[0m17:15:17.379222 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:15:17.379794 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: COMMIT
[0m17:15:17.381786 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:15:17.383936 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:15:17.384122 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_second_dbt_model"} */
drop view if exists "covid"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:15:17.384469 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:15:17.385309 [debug] [Thread-3 (]: finished collecting timing info
[0m17:15:17.385483 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: Close
[0m17:15:17.385866 [info ] [Thread-3 (]: 2 of 2 OK created view model public.my_second_dbt_model ................................................................ [[32mCREATE VIEW[0m in 0.05s]
[0m17:15:17.386219 [debug] [Thread-3 (]: Finished running node model.postgres_test.my_second_dbt_model
[0m17:15:17.387308 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:15:17.387480 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:17.387608 [debug] [MainThread]: On master: BEGIN
[0m17:15:17.387743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:17.390040 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:15:17.390352 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.390511 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:17.390645 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.390854 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:15:17.391023 [debug] [MainThread]: On master: Close
[0m17:15:17.391712 [info ] [MainThread]: 
[0m17:15:17.392195 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:15:17.392572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:17.392753 [debug] [MainThread]: Connection 'model.postgres_test.my_first_dbt_model' was properly closed.
[0m17:15:17.392936 [debug] [MainThread]: Connection 'model.postgres_test.my_second_dbt_model' was properly closed.
[0m17:15:17.400705 [info ] [MainThread]: 
[0m17:15:17.400999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:17.401329 [info ] [MainThread]: 
[0m17:15:17.401560 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2022-08-03 17:20:12.535999 | 0c921a47-1dd0-401c-adc4-6e1e868ec102 ==============================
[0m17:20:12.536035 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:20:12.537302 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:20:12.537646 [debug] [MainThread]: Tracking: do not track
[0m17:20:12.597062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:20:12.597508 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/example/my_first_dbt_model.sql
[0m17:20:12.612465 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:20:12.657708 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:20:12.658836 [info ] [MainThread]: 
[0m17:20:12.659248 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:20:12.659872 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid"
[0m17:20:12.671579 [debug] [ThreadPool]: Using postgres connection "list_covid"
[0m17:20:12.672136 [debug] [ThreadPool]: On list_covid: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "list_covid"} */

    select distinct nspname from pg_namespace
  
[0m17:20:12.672350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:12.700686 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
[0m17:20:12.701962 [debug] [ThreadPool]: On list_covid: Close
[0m17:20:12.703362 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid_public"
[0m17:20:12.710085 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:20:12.710293 [debug] [ThreadPool]: On list_covid_public: BEGIN
[0m17:20:12.710430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:12.712939 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:20:12.713147 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:20:12.713283 [debug] [ThreadPool]: On list_covid_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "list_covid_public"} */
select
      'covid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'covid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:20:12.717852 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:20:12.718974 [debug] [ThreadPool]: On list_covid_public: ROLLBACK
[0m17:20:12.719285 [debug] [ThreadPool]: On list_covid_public: Close
[0m17:20:12.724020 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:12.724247 [debug] [MainThread]: On master: BEGIN
[0m17:20:12.724387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:12.726828 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:20:12.727022 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:12.727157 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:20:12.735473 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m17:20:12.738449 [debug] [MainThread]: On master: ROLLBACK
[0m17:20:12.738911 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:12.739096 [debug] [MainThread]: On master: BEGIN
[0m17:20:12.739465 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:20:12.739747 [debug] [MainThread]: On master: COMMIT
[0m17:20:12.739978 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:12.740191 [debug] [MainThread]: On master: COMMIT
[0m17:20:12.740634 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:20:12.740859 [debug] [MainThread]: On master: Close
[0m17:20:12.741357 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m17:20:12.742318 [info ] [MainThread]: 
[0m17:20:12.750778 [debug] [Thread-1 (]: Began running node model.postgres_test.my_first_dbt_model
[0m17:20:12.751340 [info ] [Thread-1 (]: 1 of 2 START table model public.my_first_dbt_model ..................................................................... [RUN]
[0m17:20:12.752180 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:20:12.752433 [debug] [Thread-1 (]: Began compiling node model.postgres_test.my_first_dbt_model
[0m17:20:12.752667 [debug] [Thread-1 (]: Compiling model.postgres_test.my_first_dbt_model
[0m17:20:12.755103 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.my_first_dbt_model"
[0m17:20:12.756373 [debug] [Thread-1 (]: finished collecting timing info
[0m17:20:12.756564 [debug] [Thread-1 (]: Began executing node model.postgres_test.my_first_dbt_model
[0m17:20:12.794078 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.my_first_dbt_model"
[0m17:20:12.795114 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:20:12.795272 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: BEGIN
[0m17:20:12.795399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:12.798098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:20:12.798340 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:20:12.798491 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */


  create  table "covid"."public"."my_first_dbt_model__dbt_tmp"
  as (
    

with agg as (

    select  SUM(new_tested) as Total_Testados, 
            SUM(new_deceased) as Total_Mortos,
            SUM(total_tested) as Total_Testados
    from epidemiology_data
    group by date 
)

select *
from agg

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:20:12.801900 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "total_testados" specified more than once

[0m17:20:12.802487 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: ROLLBACK
[0m17:20:12.803601 [debug] [Thread-1 (]: finished collecting timing info
[0m17:20:12.804173 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: Close
[0m17:20:12.805421 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  column "total_testados" specified more than once
  compiled SQL at target/run/postgres_test/models/example/my_first_dbt_model.sql
[0m17:20:12.806233 [error] [Thread-1 (]: 1 of 2 ERROR creating table model public.my_first_dbt_model ............................................................ [[31mERROR[0m in 0.05s]
[0m17:20:12.807277 [debug] [Thread-1 (]: Finished running node model.postgres_test.my_first_dbt_model
[0m17:20:12.808108 [debug] [Thread-3 (]: Began running node model.postgres_test.my_second_dbt_model
[0m17:20:12.808312 [info ] [Thread-3 (]: 2 of 2 SKIP relation public.my_second_dbt_model ........................................................................ [[33mSKIP[0m]
[0m17:20:12.809104 [debug] [Thread-3 (]: Finished running node model.postgres_test.my_second_dbt_model
[0m17:20:12.810174 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:20:12.810462 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:12.810648 [debug] [MainThread]: On master: BEGIN
[0m17:20:12.810831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:12.814423 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:20:12.814748 [debug] [MainThread]: On master: COMMIT
[0m17:20:12.814904 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:12.815061 [debug] [MainThread]: On master: COMMIT
[0m17:20:12.815308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:20:12.815599 [debug] [MainThread]: On master: Close
[0m17:20:12.816452 [info ] [MainThread]: 
[0m17:20:12.816814 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m17:20:12.817063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:12.817192 [debug] [MainThread]: Connection 'model.postgres_test.my_first_dbt_model' was properly closed.
[0m17:20:12.824460 [info ] [MainThread]: 
[0m17:20:12.825063 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:20:12.825638 [info ] [MainThread]: 
[0m17:20:12.826114 [error] [MainThread]: [33mDatabase Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)[0m
[0m17:20:12.826585 [error] [MainThread]:   column "total_testados" specified more than once
[0m17:20:12.826913 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/example/my_first_dbt_model.sql
[0m17:20:12.827190 [info ] [MainThread]: 
[0m17:20:12.827439 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2


============================== 2022-08-03 17:20:33.109338 | c3f7f3a3-7283-4e50-a67f-3a85dda8df89 ==============================
[0m17:20:33.109356 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:20:33.109905 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:20:33.110154 [debug] [MainThread]: Tracking: do not track
[0m17:20:33.160101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:20:33.160502 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/example/my_first_dbt_model.sql
[0m17:20:33.173138 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:20:33.218927 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:20:33.219914 [info ] [MainThread]: 
[0m17:20:33.220307 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:20:33.220918 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid"
[0m17:20:33.229733 [debug] [ThreadPool]: Using postgres connection "list_covid"
[0m17:20:33.229959 [debug] [ThreadPool]: On list_covid: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "list_covid"} */

    select distinct nspname from pg_namespace
  
[0m17:20:33.230113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:33.239659 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m17:20:33.242256 [debug] [ThreadPool]: On list_covid: Close
[0m17:20:33.243941 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid_public"
[0m17:20:33.250276 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:20:33.250600 [debug] [ThreadPool]: On list_covid_public: BEGIN
[0m17:20:33.250754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:33.253513 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:20:33.253738 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:20:33.253878 [debug] [ThreadPool]: On list_covid_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "list_covid_public"} */
select
      'covid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'covid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:20:33.256530 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:20:33.259581 [debug] [ThreadPool]: On list_covid_public: ROLLBACK
[0m17:20:33.260786 [debug] [ThreadPool]: On list_covid_public: Close
[0m17:20:33.267246 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:33.267704 [debug] [MainThread]: On master: BEGIN
[0m17:20:33.267895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:33.271341 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:20:33.271687 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:33.271862 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:20:33.281067 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m17:20:33.282317 [debug] [MainThread]: On master: ROLLBACK
[0m17:20:33.282686 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:33.282844 [debug] [MainThread]: On master: BEGIN
[0m17:20:33.283093 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:20:33.283236 [debug] [MainThread]: On master: COMMIT
[0m17:20:33.283362 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:33.283482 [debug] [MainThread]: On master: COMMIT
[0m17:20:33.283692 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:20:33.283839 [debug] [MainThread]: On master: Close
[0m17:20:33.284228 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m17:20:33.284746 [info ] [MainThread]: 
[0m17:20:33.288256 [debug] [Thread-1 (]: Began running node model.postgres_test.my_first_dbt_model
[0m17:20:33.288539 [info ] [Thread-1 (]: 1 of 2 START table model public.my_first_dbt_model ..................................................................... [RUN]
[0m17:20:33.288940 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:20:33.289104 [debug] [Thread-1 (]: Began compiling node model.postgres_test.my_first_dbt_model
[0m17:20:33.289246 [debug] [Thread-1 (]: Compiling model.postgres_test.my_first_dbt_model
[0m17:20:33.292443 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.my_first_dbt_model"
[0m17:20:33.292830 [debug] [Thread-1 (]: finished collecting timing info
[0m17:20:33.293084 [debug] [Thread-1 (]: Began executing node model.postgres_test.my_first_dbt_model
[0m17:20:33.344017 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.my_first_dbt_model"
[0m17:20:33.344761 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:20:33.344969 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: BEGIN
[0m17:20:33.345121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:33.347999 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:20:33.348389 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:20:33.348548 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */


  create  table "covid"."public"."my_first_dbt_model__dbt_tmp"
  as (
    

with agg as (

    select  SUM(new_tested) as Novos_Testados, 
            SUM(new_deceased) as Total_Mortos,
            SUM(total_tested) as Total_Testados
    from epidemiology_data
    group by date 
)

select *
from agg

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:20:33.353781 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m17:20:33.360277 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:20:33.360534 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */
alter table "covid"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:20:33.361089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:20:33.363278 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:20:33.363488 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */
alter table "covid"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:20:33.363870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:20:33.392172 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: COMMIT
[0m17:20:33.392400 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:20:33.392538 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: COMMIT
[0m17:20:33.394575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:20:33.399942 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:20:33.400193 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */
drop table if exists "covid"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:20:33.403592 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:20:33.404480 [debug] [Thread-1 (]: finished collecting timing info
[0m17:20:33.404646 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: Close
[0m17:20:33.405066 [info ] [Thread-1 (]: 1 of 2 OK created table model public.my_first_dbt_model ................................................................ [[32mSELECT 2[0m in 0.12s]
[0m17:20:33.405436 [debug] [Thread-1 (]: Finished running node model.postgres_test.my_first_dbt_model
[0m17:20:33.406173 [debug] [Thread-3 (]: Began running node model.postgres_test.my_second_dbt_model
[0m17:20:33.406735 [info ] [Thread-3 (]: 2 of 2 START view model public.my_second_dbt_model ..................................................................... [RUN]
[0m17:20:33.407631 [debug] [Thread-3 (]: Acquiring new postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:20:33.407785 [debug] [Thread-3 (]: Began compiling node model.postgres_test.my_second_dbt_model
[0m17:20:33.407963 [debug] [Thread-3 (]: Compiling model.postgres_test.my_second_dbt_model
[0m17:20:33.410306 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_test.my_second_dbt_model"
[0m17:20:33.410660 [debug] [Thread-3 (]: finished collecting timing info
[0m17:20:33.410835 [debug] [Thread-3 (]: Began executing node model.postgres_test.my_second_dbt_model
[0m17:20:33.429137 [debug] [Thread-3 (]: Writing runtime SQL for node "model.postgres_test.my_second_dbt_model"
[0m17:20:33.429601 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:20:33.429748 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: BEGIN
[0m17:20:33.429875 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:20:33.432866 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:20:33.433313 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:20:33.433510 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_second_dbt_model"} */

  create view "covid"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "covid"."public"."my_first_dbt_model"
where id = 1
  );
[0m17:20:33.435902 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 8: where id = 1
              ^

[0m17:20:33.437375 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: ROLLBACK
[0m17:20:33.438977 [debug] [Thread-3 (]: finished collecting timing info
[0m17:20:33.439643 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: Close
[0m17:20:33.441184 [debug] [Thread-3 (]: Database Error in model my_second_dbt_model (models/example/my_second_dbt_model.sql)
  column "id" does not exist
  LINE 8: where id = 1
                ^
  compiled SQL at target/run/postgres_test/models/example/my_second_dbt_model.sql
[0m17:20:33.442490 [error] [Thread-3 (]: 2 of 2 ERROR creating view model public.my_second_dbt_model ............................................................ [[31mERROR[0m in 0.03s]
[0m17:20:33.444002 [debug] [Thread-3 (]: Finished running node model.postgres_test.my_second_dbt_model
[0m17:20:33.445899 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:20:33.446232 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:33.446379 [debug] [MainThread]: On master: BEGIN
[0m17:20:33.446505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:33.450228 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:20:33.450799 [debug] [MainThread]: On master: COMMIT
[0m17:20:33.451139 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:33.451288 [debug] [MainThread]: On master: COMMIT
[0m17:20:33.451509 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:20:33.451665 [debug] [MainThread]: On master: Close
[0m17:20:33.452166 [info ] [MainThread]: 
[0m17:20:33.452576 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m17:20:33.452973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:33.453330 [debug] [MainThread]: Connection 'model.postgres_test.my_first_dbt_model' was properly closed.
[0m17:20:33.453651 [debug] [MainThread]: Connection 'model.postgres_test.my_second_dbt_model' was properly closed.
[0m17:20:33.462494 [info ] [MainThread]: 
[0m17:20:33.462836 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:20:33.463134 [info ] [MainThread]: 
[0m17:20:33.463371 [error] [MainThread]: [33mDatabase Error in model my_second_dbt_model (models/example/my_second_dbt_model.sql)[0m
[0m17:20:33.463601 [error] [MainThread]:   column "id" does not exist
[0m17:20:33.463819 [error] [MainThread]:   LINE 8: where id = 1
[0m17:20:33.464052 [error] [MainThread]:                 ^
[0m17:20:33.464348 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/example/my_second_dbt_model.sql
[0m17:20:33.465183 [info ] [MainThread]: 
[0m17:20:33.465476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2


============================== 2022-08-03 17:21:02.583697 | a24b0e1c-945e-4b4c-b0a7-32c3b8d83c7a ==============================
[0m17:21:02.583711 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:21:02.584072 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:21:02.584213 [debug] [MainThread]: Tracking: do not track
[0m17:21:02.610639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:02.611257 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/example/my_second_dbt_model.sql
[0m17:21:02.630679 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m17:21:02.673736 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:21:02.674804 [info ] [MainThread]: 
[0m17:21:02.675272 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:21:02.675931 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid"
[0m17:21:02.689353 [debug] [ThreadPool]: Using postgres connection "list_covid"
[0m17:21:02.689569 [debug] [ThreadPool]: On list_covid: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "list_covid"} */

    select distinct nspname from pg_namespace
  
[0m17:21:02.689725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:02.693351 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:21:02.694577 [debug] [ThreadPool]: On list_covid: Close
[0m17:21:02.696445 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid_public"
[0m17:21:02.704591 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:21:02.704817 [debug] [ThreadPool]: On list_covid_public: BEGIN
[0m17:21:02.704965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:02.707821 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:21:02.708092 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:21:02.708242 [debug] [ThreadPool]: On list_covid_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "list_covid_public"} */
select
      'covid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'covid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:21:02.710232 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:21:02.711624 [debug] [ThreadPool]: On list_covid_public: ROLLBACK
[0m17:21:02.712424 [debug] [ThreadPool]: On list_covid_public: Close
[0m17:21:02.717080 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:02.717440 [debug] [MainThread]: On master: BEGIN
[0m17:21:02.717606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:02.720472 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:02.720686 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:02.720818 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:21:02.727681 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m17:21:02.729620 [debug] [MainThread]: On master: ROLLBACK
[0m17:21:02.729985 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:02.730149 [debug] [MainThread]: On master: BEGIN
[0m17:21:02.730672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:02.731026 [debug] [MainThread]: On master: COMMIT
[0m17:21:02.731166 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:02.731299 [debug] [MainThread]: On master: COMMIT
[0m17:21:02.731534 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:21:02.731695 [debug] [MainThread]: On master: Close
[0m17:21:02.732065 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m17:21:02.732383 [info ] [MainThread]: 
[0m17:21:02.736324 [debug] [Thread-1 (]: Began running node model.postgres_test.my_first_dbt_model
[0m17:21:02.736634 [info ] [Thread-1 (]: 1 of 2 START table model public.my_first_dbt_model ..................................................................... [RUN]
[0m17:21:02.737056 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:21:02.737206 [debug] [Thread-1 (]: Began compiling node model.postgres_test.my_first_dbt_model
[0m17:21:02.737346 [debug] [Thread-1 (]: Compiling model.postgres_test.my_first_dbt_model
[0m17:21:02.739258 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.my_first_dbt_model"
[0m17:21:02.739555 [debug] [Thread-1 (]: finished collecting timing info
[0m17:21:02.739711 [debug] [Thread-1 (]: Began executing node model.postgres_test.my_first_dbt_model
[0m17:21:02.784733 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.my_first_dbt_model"
[0m17:21:02.785131 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:21:02.785282 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: BEGIN
[0m17:21:02.785410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:02.787762 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:21:02.788014 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:21:02.788232 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */


  create  table "covid"."public"."my_first_dbt_model__dbt_tmp"
  as (
    

with agg as (

    select  SUM(new_tested) as Novos_Testados, 
            SUM(new_deceased) as Total_Mortos,
            SUM(total_tested) as Total_Testados
    from epidemiology_data
    group by date 
)

select *
from agg

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:21:02.790242 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m17:21:02.797707 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:21:02.797924 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */
alter table "covid"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:21:02.798413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:02.800818 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:21:02.801007 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */
alter table "covid"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:21:02.801394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:02.823628 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: COMMIT
[0m17:21:02.823850 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:21:02.823991 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: COMMIT
[0m17:21:02.825675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:21:02.831440 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:21:02.831649 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */
drop table if exists "covid"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:21:02.834071 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:21:02.835237 [debug] [Thread-1 (]: finished collecting timing info
[0m17:21:02.835442 [debug] [Thread-1 (]: On model.postgres_test.my_first_dbt_model: Close
[0m17:21:02.836517 [info ] [Thread-1 (]: 1 of 2 OK created table model public.my_first_dbt_model ................................................................ [[32mSELECT 2[0m in 0.10s]
[0m17:21:02.837209 [debug] [Thread-1 (]: Finished running node model.postgres_test.my_first_dbt_model
[0m17:21:02.838303 [debug] [Thread-3 (]: Began running node model.postgres_test.my_second_dbt_model
[0m17:21:02.838673 [info ] [Thread-3 (]: 2 of 2 START view model public.my_second_dbt_model ..................................................................... [RUN]
[0m17:21:02.839141 [debug] [Thread-3 (]: Acquiring new postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:21:02.839289 [debug] [Thread-3 (]: Began compiling node model.postgres_test.my_second_dbt_model
[0m17:21:02.839424 [debug] [Thread-3 (]: Compiling model.postgres_test.my_second_dbt_model
[0m17:21:02.841220 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_test.my_second_dbt_model"
[0m17:21:02.841510 [debug] [Thread-3 (]: finished collecting timing info
[0m17:21:02.841662 [debug] [Thread-3 (]: Began executing node model.postgres_test.my_second_dbt_model
[0m17:21:02.860005 [debug] [Thread-3 (]: Writing runtime SQL for node "model.postgres_test.my_second_dbt_model"
[0m17:21:02.860589 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:21:02.860993 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: BEGIN
[0m17:21:02.861373 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:21:02.864754 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:21:02.865014 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:21:02.865208 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_second_dbt_model"} */

  create view "covid"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "covid"."public"."my_first_dbt_model"
  );
[0m17:21:02.867669 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:21:02.871864 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:21:02.872144 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_second_dbt_model"} */
alter table "covid"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:21:02.872820 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:02.874593 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: COMMIT
[0m17:21:02.874783 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:21:02.874918 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: COMMIT
[0m17:21:02.876854 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:21:02.878842 [debug] [Thread-3 (]: Using postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:21:02.879047 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_second_dbt_model"} */
drop view if exists "covid"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:21:02.879533 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:21:02.881069 [debug] [Thread-3 (]: finished collecting timing info
[0m17:21:02.881862 [debug] [Thread-3 (]: On model.postgres_test.my_second_dbt_model: Close
[0m17:21:02.883638 [info ] [Thread-3 (]: 2 of 2 OK created view model public.my_second_dbt_model ................................................................ [[32mCREATE VIEW[0m in 0.04s]
[0m17:21:02.884757 [debug] [Thread-3 (]: Finished running node model.postgres_test.my_second_dbt_model
[0m17:21:02.888414 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:21:02.888879 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:02.889104 [debug] [MainThread]: On master: BEGIN
[0m17:21:02.889241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:02.893099 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:02.893506 [debug] [MainThread]: On master: COMMIT
[0m17:21:02.893671 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:02.893858 [debug] [MainThread]: On master: COMMIT
[0m17:21:02.894207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:21:02.894386 [debug] [MainThread]: On master: Close
[0m17:21:02.894979 [info ] [MainThread]: 
[0m17:21:02.895472 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m17:21:02.895791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:02.895918 [debug] [MainThread]: Connection 'model.postgres_test.my_first_dbt_model' was properly closed.
[0m17:21:02.896038 [debug] [MainThread]: Connection 'model.postgres_test.my_second_dbt_model' was properly closed.
[0m17:21:02.907828 [info ] [MainThread]: 
[0m17:21:02.908423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:02.908794 [info ] [MainThread]: 
[0m17:21:02.909019 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2022-08-03 17:40:25.705406 | ce23fa1b-d045-4a6b-85ef-fd1419cbed75 ==============================
[0m17:40:25.705422 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:40:25.706074 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m17:40:25.706253 [debug] [MainThread]: Tracking: do not track
[0m17:40:25.755312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:40:25.756092 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/example/my_first_dbt_model.sql
[0m17:40:25.770154 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:40:25.808754 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:40:25.809781 [info ] [MainThread]: 
[0m17:40:25.810152 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:40:25.810699 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid_public"
[0m17:40:25.818311 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:40:25.818539 [debug] [ThreadPool]: On list_covid_public: BEGIN
[0m17:40:25.818688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:25.820030 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m17:40:26.823051 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m17:40:26.823740 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:40:26.824491 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m17:40:26.825113 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:40:26.825761 [debug] [ThreadPool]: On list_covid_public: No close available on handle
[0m17:40:26.827882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:26.828688 [debug] [MainThread]: Connection 'list_covid_public' was properly closed.


============================== 2022-08-03 17:40:55.758444 | 90b974a6-c9e8-4ae3-806a-c800f116cee1 ==============================
[0m17:40:55.758481 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:40:55.759016 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m17:40:55.759231 [debug] [MainThread]: Tracking: do not track
[0m17:40:55.794196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:55.794485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:55.806709 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:40:55.809545 [info ] [MainThread]: 
[0m17:40:55.811717 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:40:55.812967 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid_public"
[0m17:40:55.828285 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:40:55.828823 [debug] [ThreadPool]: On list_covid_public: BEGIN
[0m17:40:55.829011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:55.861785 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m17:40:55.862166 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:40:55.862422 [debug] [ThreadPool]: On list_covid_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "list_covid_public"} */
select
      'covid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'covid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:40:55.897537 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
[0m17:40:55.902967 [debug] [ThreadPool]: On list_covid_public: ROLLBACK
[0m17:40:55.904178 [debug] [ThreadPool]: On list_covid_public: Close
[0m17:40:55.925673 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:55.926567 [debug] [MainThread]: On master: BEGIN
[0m17:40:55.926989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:55.935153 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:40:55.935587 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:55.935978 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:40:55.959185 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m17:40:55.960582 [debug] [MainThread]: On master: ROLLBACK
[0m17:40:55.961318 [debug] [MainThread]: On master: Close
[0m17:40:55.961770 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m17:40:55.962128 [info ] [MainThread]: 
[0m17:40:55.971769 [debug] [Thread-1 (]: Began running node model.postgres_test.my_first_dbt_model
[0m17:40:55.972210 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:40:55.972400 [debug] [Thread-1 (]: Began compiling node model.postgres_test.my_first_dbt_model
[0m17:40:55.972567 [debug] [Thread-1 (]: Compiling model.postgres_test.my_first_dbt_model
[0m17:40:55.975627 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.my_first_dbt_model"
[0m17:40:55.976108 [debug] [Thread-1 (]: finished collecting timing info
[0m17:40:55.976380 [debug] [Thread-1 (]: Began executing node model.postgres_test.my_first_dbt_model
[0m17:40:55.976583 [debug] [Thread-1 (]: finished collecting timing info
[0m17:40:55.977306 [debug] [Thread-1 (]: Finished running node model.postgres_test.my_first_dbt_model
[0m17:40:55.978038 [debug] [Thread-3 (]: Began running node model.postgres_test.my_second_dbt_model
[0m17:40:55.978321 [debug] [Thread-4 (]: Began running node test.postgres_test.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:40:55.978723 [debug] [Thread-3 (]: Acquiring new postgres connection "model.postgres_test.my_second_dbt_model"
[0m17:40:55.978929 [debug] [Thread-5 (]: Began running node test.postgres_test.unique_my_first_dbt_model_id.16e066b321
[0m17:40:55.979362 [debug] [Thread-4 (]: Acquiring new postgres connection "test.postgres_test.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:40:55.979597 [debug] [Thread-3 (]: Began compiling node model.postgres_test.my_second_dbt_model
[0m17:40:55.979989 [debug] [Thread-5 (]: Acquiring new postgres connection "test.postgres_test.unique_my_first_dbt_model_id.16e066b321"
[0m17:40:55.980224 [debug] [Thread-4 (]: Began compiling node test.postgres_test.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:40:55.980514 [debug] [Thread-3 (]: Compiling model.postgres_test.my_second_dbt_model
[0m17:40:55.980741 [debug] [Thread-5 (]: Began compiling node test.postgres_test.unique_my_first_dbt_model_id.16e066b321
[0m17:40:55.980949 [debug] [Thread-4 (]: Compiling test.postgres_test.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:40:55.983042 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_test.my_second_dbt_model"
[0m17:40:55.983283 [debug] [Thread-5 (]: Compiling test.postgres_test.unique_my_first_dbt_model_id.16e066b321
[0m17:40:55.998007 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_test.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:40:56.004745 [debug] [Thread-5 (]: Writing injected SQL for node "test.postgres_test.unique_my_first_dbt_model_id.16e066b321"
[0m17:40:56.005265 [debug] [Thread-3 (]: finished collecting timing info
[0m17:40:56.005864 [debug] [Thread-3 (]: Began executing node model.postgres_test.my_second_dbt_model
[0m17:40:56.006335 [debug] [Thread-3 (]: finished collecting timing info
[0m17:40:56.007384 [debug] [Thread-3 (]: Finished running node model.postgres_test.my_second_dbt_model
[0m17:40:56.007781 [debug] [Thread-4 (]: finished collecting timing info
[0m17:40:56.008223 [debug] [Thread-5 (]: finished collecting timing info
[0m17:40:56.009346 [debug] [Thread-4 (]: Began executing node test.postgres_test.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:40:56.010119 [debug] [Thread-7 (]: Began running node test.postgres_test.not_null_my_second_dbt_model_id.151b76d778
[0m17:40:56.010542 [debug] [Thread-8 (]: Began running node test.postgres_test.unique_my_second_dbt_model_id.57a0f8c493
[0m17:40:56.010909 [debug] [Thread-5 (]: Began executing node test.postgres_test.unique_my_first_dbt_model_id.16e066b321
[0m17:40:56.011189 [debug] [Thread-4 (]: finished collecting timing info
[0m17:40:56.011818 [debug] [Thread-7 (]: Acquiring new postgres connection "test.postgres_test.not_null_my_second_dbt_model_id.151b76d778"
[0m17:40:56.012334 [debug] [Thread-8 (]: Acquiring new postgres connection "test.postgres_test.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:40:56.012598 [debug] [Thread-5 (]: finished collecting timing info
[0m17:40:56.013036 [debug] [Thread-4 (]: Finished running node test.postgres_test.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:40:56.013288 [debug] [Thread-7 (]: Began compiling node test.postgres_test.not_null_my_second_dbt_model_id.151b76d778
[0m17:40:56.013523 [debug] [Thread-8 (]: Began compiling node test.postgres_test.unique_my_second_dbt_model_id.57a0f8c493
[0m17:40:56.014075 [debug] [Thread-5 (]: Finished running node test.postgres_test.unique_my_first_dbt_model_id.16e066b321
[0m17:40:56.014932 [debug] [Thread-7 (]: Compiling test.postgres_test.not_null_my_second_dbt_model_id.151b76d778
[0m17:40:56.015260 [debug] [Thread-8 (]: Compiling test.postgres_test.unique_my_second_dbt_model_id.57a0f8c493
[0m17:40:56.021702 [debug] [Thread-7 (]: Writing injected SQL for node "test.postgres_test.not_null_my_second_dbt_model_id.151b76d778"
[0m17:40:56.026227 [debug] [Thread-8 (]: Writing injected SQL for node "test.postgres_test.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:40:56.027588 [debug] [Thread-8 (]: finished collecting timing info
[0m17:40:56.027942 [debug] [Thread-7 (]: finished collecting timing info
[0m17:40:56.028375 [debug] [Thread-8 (]: Began executing node test.postgres_test.unique_my_second_dbt_model_id.57a0f8c493
[0m17:40:56.028668 [debug] [Thread-7 (]: Began executing node test.postgres_test.not_null_my_second_dbt_model_id.151b76d778
[0m17:40:56.028910 [debug] [Thread-8 (]: finished collecting timing info
[0m17:40:56.029124 [debug] [Thread-7 (]: finished collecting timing info
[0m17:40:56.029676 [debug] [Thread-8 (]: Finished running node test.postgres_test.unique_my_second_dbt_model_id.57a0f8c493
[0m17:40:56.030169 [debug] [Thread-7 (]: Finished running node test.postgres_test.not_null_my_second_dbt_model_id.151b76d778
[0m17:40:56.031381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:56.031589 [debug] [MainThread]: Connection 'model.postgres_test.my_first_dbt_model' was properly closed.
[0m17:40:56.031760 [debug] [MainThread]: Connection 'model.postgres_test.my_second_dbt_model' was properly closed.
[0m17:40:56.031920 [debug] [MainThread]: Connection 'test.postgres_test.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m17:40:56.032075 [debug] [MainThread]: Connection 'test.postgres_test.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m17:40:56.032235 [debug] [MainThread]: Connection 'test.postgres_test.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m17:40:56.032388 [debug] [MainThread]: Connection 'test.postgres_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:40:56.038159 [info ] [MainThread]: Done.
[0m17:40:56.047441 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
[0m17:40:56.047668 [info ] [MainThread]: Building catalog
[0m17:40:56.048692 [debug] [ThreadPool]: Acquiring new postgres connection "covid.information_schema"
[0m17:40:56.057759 [debug] [ThreadPool]: Using postgres connection "covid.information_schema"
[0m17:40:56.058013 [debug] [ThreadPool]: On covid.information_schema: BEGIN
[0m17:40:56.058178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:56.061263 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:40:56.061513 [debug] [ThreadPool]: Using postgres connection "covid.information_schema"
[0m17:40:56.061678 [debug] [ThreadPool]: On covid.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "covid.information_schema"} */

    
    

    select
        'covid' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:40:56.079876 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.02 seconds
[0m17:40:56.093635 [debug] [ThreadPool]: On covid.information_schema: ROLLBACK
[0m17:40:56.094516 [debug] [ThreadPool]: On covid.information_schema: Close
[0m17:40:56.101891 [info ] [MainThread]: Catalog written to /home/rodrigo/repos/eds/estudos/dbt/postgres_test/target/catalog.json
[0m17:40:56.102928 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:40:56.103184 [debug] [MainThread]: Connection 'covid.information_schema' was properly closed.


============================== 2022-08-03 17:44:15.550013 | f68e958a-fb4e-4c13-b1f6-0efd140c5c5c ==============================
[0m17:44:15.550026 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:44:15.550787 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m17:44:15.551155 [debug] [MainThread]: Tracking: do not track
[0m17:44:15.560885 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m17:44:15.561197 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m17:44:15.561508 [info ] [MainThread]: 
[0m17:44:15.561828 [info ] [MainThread]: 
[0m17:44:15.562173 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-08-03 17:52:48.871527 | 1539fa3a-b9aa-41a4-b30f-b9cb60cfb4ec ==============================
[0m17:52:48.871537 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:52:48.871890 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:52:48.872039 [debug] [MainThread]: Tracking: do not track
[0m17:52:48.908174 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m17:52:48.908750 [debug] [MainThread]: Partial parsing: added file: postgres_test://models/example/dim_mes.sql
[0m17:52:48.909032 [debug] [MainThread]: Partial parsing: deleted file: postgres_test://models/example/my_second_dbt_model.sql
[0m17:52:48.909352 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/example/my_first_dbt_model.sql
[0m17:52:48.922417 [debug] [MainThread]: 1603: static parser failed on example/dim_mes.sql
[0m17:52:48.935351 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/dim_mes.sql
[0m17:52:48.936855 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:52:48.947130 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m17:52:48.966268 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.postgres_test.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' which was not found
[0m17:52:48.966600 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.postgres_test.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' which was not found
[0m17:52:48.982145 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:52:48.983232 [info ] [MainThread]: 
[0m17:52:48.983769 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:52:48.984606 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid"
[0m17:52:48.993564 [debug] [ThreadPool]: Using postgres connection "list_covid"
[0m17:52:48.993800 [debug] [ThreadPool]: On list_covid: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "list_covid"} */

    select distinct nspname from pg_namespace
  
[0m17:52:48.993949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:49.013197 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
[0m17:52:49.017913 [debug] [ThreadPool]: On list_covid: Close
[0m17:52:49.020783 [debug] [ThreadPool]: Acquiring new postgres connection "list_covid_public"
[0m17:52:49.035702 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:52:49.036269 [debug] [ThreadPool]: On list_covid_public: BEGIN
[0m17:52:49.036697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:49.041803 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:52:49.042582 [debug] [ThreadPool]: Using postgres connection "list_covid_public"
[0m17:52:49.043096 [debug] [ThreadPool]: On list_covid_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "list_covid_public"} */
select
      'covid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'covid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:52:49.047887 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:52:49.050080 [debug] [ThreadPool]: On list_covid_public: ROLLBACK
[0m17:52:49.050506 [debug] [ThreadPool]: On list_covid_public: Close
[0m17:52:49.056244 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:49.056505 [debug] [MainThread]: On master: BEGIN
[0m17:52:49.056676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:49.060602 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:52:49.061034 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:49.061222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:52:49.071865 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m17:52:49.073198 [debug] [MainThread]: On master: ROLLBACK
[0m17:52:49.073566 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:49.073767 [debug] [MainThread]: On master: BEGIN
[0m17:52:49.074212 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:52:49.074456 [debug] [MainThread]: On master: COMMIT
[0m17:52:49.074634 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:49.074801 [debug] [MainThread]: On master: COMMIT
[0m17:52:49.075169 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:52:49.075451 [debug] [MainThread]: On master: Close
[0m17:52:49.076428 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m17:52:49.076869 [info ] [MainThread]: 
[0m17:52:49.083896 [debug] [Thread-1 (]: Began running node model.postgres_test.dim_mes
[0m17:52:49.084195 [debug] [Thread-2 (]: Began running node model.postgres_test.my_first_dbt_model
[0m17:52:49.084499 [info ] [Thread-1 (]: 1 of 2 START table model public.dim_mes ................................................................................ [RUN]
[0m17:52:49.084895 [info ] [Thread-2 (]: 2 of 2 START table model public.my_first_dbt_model ..................................................................... [RUN]
[0m17:52:49.085473 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m17:52:49.086173 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:52:49.086499 [debug] [Thread-1 (]: Began compiling node model.postgres_test.dim_mes
[0m17:52:49.086756 [debug] [Thread-2 (]: Began compiling node model.postgres_test.my_first_dbt_model
[0m17:52:49.086999 [debug] [Thread-1 (]: Compiling model.postgres_test.dim_mes
[0m17:52:49.087242 [debug] [Thread-2 (]: Compiling model.postgres_test.my_first_dbt_model
[0m17:52:49.089584 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m17:52:49.092029 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.my_first_dbt_model"
[0m17:52:49.092898 [debug] [Thread-1 (]: finished collecting timing info
[0m17:52:49.093156 [debug] [Thread-2 (]: finished collecting timing info
[0m17:52:49.093463 [debug] [Thread-1 (]: Began executing node model.postgres_test.dim_mes
[0m17:52:49.093715 [debug] [Thread-2 (]: Began executing node model.postgres_test.my_first_dbt_model
[0m17:52:49.179725 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m17:52:49.180674 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.my_first_dbt_model"
[0m17:52:49.181419 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:52:49.181655 [debug] [Thread-2 (]: On model.postgres_test.my_first_dbt_model: BEGIN
[0m17:52:49.181870 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:52:49.182335 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m17:52:49.182553 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: BEGIN
[0m17:52:49.182775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:49.185312 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:52:49.185755 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.my_first_dbt_model"
[0m17:52:49.185942 [debug] [Thread-2 (]: On model.postgres_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.my_first_dbt_model"} */


  create  table "covid"."public"."my_first_dbt_model__dbt_tmp"
  as (
    

with agg as (
    select  SUM(new_tested) as Novos_Testados, 
            SUM(new_deceased) as Total_Mortos,
            SUM(total_tested) as Total_Testados,
    from epidemiology_data
    group by date 
)
    
select *
from agg

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:52:49.186116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:52:49.186463 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m17:52:49.186676 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "postgres_test", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "covid"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT DISTINCT mes_acporc AS mes
FROM tb_acporc
  );
[0m17:52:49.187090 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "tb_acporc" does not exist
LINE 9: FROM tb_acporc
             ^

[0m17:52:49.187266 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 12:     from epidemiology_data
             ^

[0m17:52:49.187677 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: ROLLBACK
[0m17:52:49.187930 [debug] [Thread-2 (]: On model.postgres_test.my_first_dbt_model: ROLLBACK
[0m17:52:49.188582 [debug] [Thread-1 (]: finished collecting timing info
[0m17:52:49.188908 [debug] [Thread-2 (]: finished collecting timing info
[0m17:52:49.189113 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: Close
[0m17:52:49.189414 [debug] [Thread-2 (]: On model.postgres_test.my_first_dbt_model: Close
[0m17:52:49.189876 [debug] [Thread-1 (]: Database Error in model dim_mes (models/example/dim_mes.sql)
  relation "tb_acporc" does not exist
  LINE 9: FROM tb_acporc
               ^
  compiled SQL at target/run/postgres_test/models/example/dim_mes.sql
[0m17:52:49.190509 [error] [Thread-1 (]: 1 of 2 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.11s]
[0m17:52:49.190904 [debug] [Thread-2 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  syntax error at or near "from"
  LINE 12:     from epidemiology_data
               ^
  compiled SQL at target/run/postgres_test/models/example/my_first_dbt_model.sql
[0m17:52:49.191848 [debug] [Thread-1 (]: Finished running node model.postgres_test.dim_mes
[0m17:52:49.192547 [error] [Thread-2 (]: 2 of 2 ERROR creating table model public.my_first_dbt_model ............................................................ [[31mERROR[0m in 0.11s]
[0m17:52:49.193374 [debug] [Thread-2 (]: Finished running node model.postgres_test.my_first_dbt_model
[0m17:52:49.194818 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:52:49.195208 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:49.195450 [debug] [MainThread]: On master: BEGIN
[0m17:52:49.195626 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:49.198780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:52:49.199376 [debug] [MainThread]: On master: COMMIT
[0m17:52:49.199638 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:49.199813 [debug] [MainThread]: On master: COMMIT
[0m17:52:49.200141 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:52:49.200355 [debug] [MainThread]: On master: Close
[0m17:52:49.200786 [info ] [MainThread]: 
[0m17:52:49.201122 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m17:52:49.201428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:49.201597 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m17:52:49.201758 [debug] [MainThread]: Connection 'model.postgres_test.my_first_dbt_model' was properly closed.
[0m17:52:49.207365 [info ] [MainThread]: 
[0m17:52:49.207735 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:52:49.208094 [info ] [MainThread]: 
[0m17:52:49.208587 [error] [MainThread]: [33mDatabase Error in model dim_mes (models/example/dim_mes.sql)[0m
[0m17:52:49.208915 [error] [MainThread]:   relation "tb_acporc" does not exist
[0m17:52:49.209257 [error] [MainThread]:   LINE 9: FROM tb_acporc
[0m17:52:49.209647 [error] [MainThread]:                ^
[0m17:52:49.209930 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/example/dim_mes.sql
[0m17:52:49.210219 [info ] [MainThread]: 
[0m17:52:49.210506 [error] [MainThread]: [33mDatabase Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)[0m
[0m17:52:49.210791 [error] [MainThread]:   syntax error at or near "from"
[0m17:52:49.211064 [error] [MainThread]:   LINE 12:     from epidemiology_data
[0m17:52:49.211414 [error] [MainThread]:                ^
[0m17:52:49.211946 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/example/my_first_dbt_model.sql
[0m17:52:49.212595 [info ] [MainThread]: 
[0m17:52:49.213191 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2


============================== 2022-08-03 18:05:11.630128 | 9ca7b4e3-3759-4d54-982d-758e4a527c8b ==============================
[0m18:05:11.630138 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:05:11.630895 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:05:11.631035 [debug] [MainThread]: Tracking: do not track
[0m18:05:11.646848 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:05:11.647166 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:05:11.676328 [debug] [MainThread]: Parsing macros/relations.sql
[0m18:05:11.678337 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:05:11.680158 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:05:11.700490 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m18:05:11.701796 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:05:11.707121 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:05:11.707669 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:05:11.708078 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:05:11.708910 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:05:11.710080 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:05:11.711060 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:05:11.714514 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:05:11.720956 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:05:11.728510 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:05:11.730244 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:05:11.740938 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:05:11.746573 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:05:11.748643 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:05:11.750894 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:05:11.754403 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:05:11.765790 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:05:11.767687 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:05:11.770981 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:05:11.784894 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:05:11.790365 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:05:11.791666 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:05:11.804609 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:05:11.815408 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:05:11.825453 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:05:11.829758 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:05:11.831971 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:05:11.835343 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:05:11.847098 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:05:11.859390 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:05:11.860553 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:05:11.867690 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:05:11.869540 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:05:11.872206 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:05:11.876431 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:05:11.877468 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:05:11.880895 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:05:11.882261 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:05:11.883703 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:05:11.884370 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:05:11.885066 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:05:11.885733 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:05:11.886826 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:05:11.888126 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:05:11.889365 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:05:11.891294 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:05:11.892289 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:05:11.893193 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:05:11.893876 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:05:11.894762 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:05:11.895532 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:05:11.900061 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:05:11.901088 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:05:11.901856 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:05:11.902542 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:05:11.903372 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:05:11.904265 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:05:11.905200 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:05:11.906201 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:05:11.907079 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:05:11.908682 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:05:11.909528 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:05:11.910387 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:05:11.912149 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:05:11.912974 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:05:11.913957 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:05:11.915590 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:05:12.102768 [debug] [MainThread]: 1603: static parser failed on example/dim_mes.sql
[0m18:05:12.112316 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/dim_mes.sql
[0m18:05:12.113292 [debug] [MainThread]: 1603: static parser failed on example/soma_vals_por_mes.sql
[0m18:05:12.116523 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/soma_vals_por_mes.sql
[0m18:05:12.147686 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:05:12.148574 [info ] [MainThread]: 
[0m18:05:12.148960 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:05:12.149581 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:05:12.156571 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:05:12.156734 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:05:12.156862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:12.162061 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:05:12.163186 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:05:12.164073 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:05:12.168624 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:05:12.168785 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:05:12.168911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:12.171422 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:05:12.171617 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:05:12.171748 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:05:12.175658 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.0 seconds
[0m18:05:12.177231 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:05:12.177609 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:05:12.182093 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:12.182293 [debug] [MainThread]: On master: BEGIN
[0m18:05:12.182423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:12.184790 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:05:12.184954 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:12.185081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:05:12.188920 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:05:12.189857 [debug] [MainThread]: On master: ROLLBACK
[0m18:05:12.190121 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:12.190266 [debug] [MainThread]: On master: BEGIN
[0m18:05:12.190641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:05:12.190790 [debug] [MainThread]: On master: COMMIT
[0m18:05:12.190916 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:12.191036 [debug] [MainThread]: On master: COMMIT
[0m18:05:12.191273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:05:12.191430 [debug] [MainThread]: On master: Close
[0m18:05:12.191761 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:05:12.192004 [info ] [MainThread]: 
[0m18:05:12.195646 [debug] [Thread-1 (]: Began running node model.postgres_test.dim_mes
[0m18:05:12.195868 [debug] [Thread-2 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:05:12.196115 [info ] [Thread-1 (]: 1 of 2 START table model public.dim_mes ................................................................................ [RUN]
[0m18:05:12.196450 [info ] [Thread-2 (]: 2 of 2 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:05:12.196974 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:05:12.197460 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:05:12.197618 [debug] [Thread-1 (]: Began compiling node model.postgres_test.dim_mes
[0m18:05:12.197872 [debug] [Thread-2 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:05:12.198083 [debug] [Thread-1 (]: Compiling model.postgres_test.dim_mes
[0m18:05:12.198336 [debug] [Thread-2 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:05:12.200132 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:05:12.206838 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro get_columns_in_relation
[0m18:05:12.207286 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m18:05:12.207521 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:05:12.208007 [debug] [Thread-1 (]: finished collecting timing info
[0m18:05:12.208242 [debug] [Thread-1 (]: Began executing node model.postgres_test.dim_mes
[0m18:05:12.232230 [debug] [Thread-2 (]: finished collecting timing info
[0m18:05:12.240327 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:05:12.240646 [debug] [Thread-2 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:05:12.241441 [debug] [Thread-2 (]: Compilation Error in model soma_vals_por_mes (models/example/soma_vals_por_mes.sql)
  'TB_ACPORC' is undefined
  
  > in macro postgres__get_columns_in_relation (macros/adapters.sql)
  > called by macro get_columns_in_relation (macros/adapters/columns.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by model soma_vals_por_mes (models/example/soma_vals_por_mes.sql)
[0m18:05:12.242090 [error] [Thread-2 (]: 2 of 2 ERROR creating table model public.soma_vals_por_mes ............................................................. [[31mERROR[0m in 0.04s]
[0m18:05:12.242732 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:05:12.243142 [debug] [Thread-2 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:05:12.243342 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:05:12.243889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:12.246287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:05:12.246459 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:05:12.246606 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT DISTINCT mes_acporc AS mes
FROM tb_acporc
  );
[0m18:05:12.570115 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.32 seconds
[0m18:05:12.584114 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:05:12.584530 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
alter table "airbyte"."public"."dim_mes__dbt_tmp" rename to "dim_mes"
[0m18:05:12.585424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:05:12.608804 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:05:12.609002 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:05:12.609146 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:05:12.609953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:05:12.613626 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:05:12.613770 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
drop table if exists "airbyte"."public"."dim_mes__dbt_backup" cascade
[0m18:05:12.614043 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:05:12.614840 [debug] [Thread-1 (]: finished collecting timing info
[0m18:05:12.614995 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: Close
[0m18:05:12.615384 [info ] [Thread-1 (]: 1 of 2 OK created table model public.dim_mes ........................................................................... [[32mSELECT 13[0m in 0.42s]
[0m18:05:12.615767 [debug] [Thread-1 (]: Finished running node model.postgres_test.dim_mes
[0m18:05:12.616987 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:05:12.617156 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:12.617320 [debug] [MainThread]: On master: BEGIN
[0m18:05:12.617475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:12.619882 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:05:12.620104 [debug] [MainThread]: On master: COMMIT
[0m18:05:12.620262 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:12.620394 [debug] [MainThread]: On master: COMMIT
[0m18:05:12.620645 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:05:12.620881 [debug] [MainThread]: On master: Close
[0m18:05:12.621311 [info ] [MainThread]: 
[0m18:05:12.621575 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m18:05:12.621841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:12.621989 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:05:12.622171 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:05:12.628124 [info ] [MainThread]: 
[0m18:05:12.628594 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:05:12.628958 [info ] [MainThread]: 
[0m18:05:12.629202 [error] [MainThread]: [33mCompilation Error in model soma_vals_por_mes (models/example/soma_vals_por_mes.sql)[0m
[0m18:05:12.629472 [error] [MainThread]:   'TB_ACPORC' is undefined
[0m18:05:12.629691 [error] [MainThread]:   
[0m18:05:12.629904 [error] [MainThread]:   > in macro postgres__get_columns_in_relation (macros/adapters.sql)
[0m18:05:12.630148 [error] [MainThread]:   > called by macro get_columns_in_relation (macros/adapters/columns.sql)
[0m18:05:12.630351 [error] [MainThread]:   > called by macro statement (macros/etc/statement.sql)
[0m18:05:12.630553 [error] [MainThread]:   > called by model soma_vals_por_mes (models/example/soma_vals_por_mes.sql)
[0m18:05:12.630774 [info ] [MainThread]: 
[0m18:05:12.630987 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2


============================== 2022-08-03 18:07:40.491120 | 0486f2ca-af67-4f31-a0e8-dce2ea319b9c ==============================
[0m18:07:40.491133 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:07:40.491508 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:07:40.491649 [debug] [MainThread]: Tracking: do not track
[0m18:07:40.514420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:40.514767 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/example/soma_vals_por_mes.sql
[0m18:07:40.525408 [debug] [MainThread]: 1603: static parser failed on example/soma_vals_por_mes.sql
[0m18:07:40.536670 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/soma_vals_por_mes.sql


============================== 2022-08-03 18:07:52.726559 | 46d7a4d8-5c3e-4341-9938-77bc7444fae1 ==============================
[0m18:07:52.726569 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:07:52.726891 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:07:52.727029 [debug] [MainThread]: Tracking: do not track
[0m18:07:52.749246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:52.749752 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/example/soma_vals_por_mes.sql
[0m18:07:52.758829 [debug] [MainThread]: 1603: static parser failed on example/soma_vals_por_mes.sql
[0m18:07:52.770663 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/soma_vals_por_mes.sql
[0m18:07:52.787139 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:07:52.788063 [info ] [MainThread]: 
[0m18:07:52.788475 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:07:52.789094 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:07:52.796187 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:07:52.796340 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:07:52.796468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:52.800197 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:07:52.801269 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:07:52.802315 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:07:52.807141 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:07:52.807403 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:07:52.807546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:52.809888 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:07:52.810049 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:07:52.810176 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:07:52.812077 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m18:07:52.813447 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:07:52.813690 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:07:52.818001 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:52.818238 [debug] [MainThread]: On master: BEGIN
[0m18:07:52.818387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:52.822136 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:52.822362 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:52.822505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:07:52.824790 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:07:52.825650 [debug] [MainThread]: On master: ROLLBACK
[0m18:07:52.825897 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:52.826094 [debug] [MainThread]: On master: BEGIN
[0m18:07:52.826449 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:52.826602 [debug] [MainThread]: On master: COMMIT
[0m18:07:52.826737 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:52.826867 [debug] [MainThread]: On master: COMMIT
[0m18:07:52.827097 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:07:52.827242 [debug] [MainThread]: On master: Close
[0m18:07:52.827566 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:07:52.827828 [info ] [MainThread]: 
[0m18:07:52.830954 [debug] [Thread-1 (]: Began running node model.postgres_test.dim_mes
[0m18:07:52.831176 [debug] [Thread-2 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:07:52.831423 [info ] [Thread-1 (]: 1 of 2 START table model public.dim_mes ................................................................................ [RUN]
[0m18:07:52.831753 [info ] [Thread-2 (]: 2 of 2 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:07:52.832270 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:07:52.832746 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:07:52.832971 [debug] [Thread-1 (]: Began compiling node model.postgres_test.dim_mes
[0m18:07:52.833159 [debug] [Thread-2 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:07:52.833316 [debug] [Thread-1 (]: Compiling model.postgres_test.dim_mes
[0m18:07:52.833493 [debug] [Thread-2 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:07:52.835227 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:07:52.841912 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro get_columns_in_relation
[0m18:07:52.842204 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m18:07:52.842349 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:07:52.842694 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:52.842938 [debug] [Thread-1 (]: Began executing node model.postgres_test.dim_mes
[0m18:07:52.875685 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:07:52.876186 [debug] [Thread-2 (]: finished collecting timing info
[0m18:07:52.876461 [debug] [Thread-2 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:07:52.876661 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:07:52.877037 [debug] [Thread-2 (]: Compilation Error in model soma_vals_por_mes (models/example/soma_vals_por_mes.sql)
  'str object' has no attribute 'information_schema'
  
  > in macro postgres__get_columns_in_relation (macros/adapters.sql)
  > called by macro get_columns_in_relation (macros/adapters/columns.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by model soma_vals_por_mes (models/example/soma_vals_por_mes.sql)
[0m18:07:52.877226 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:07:52.877700 [error] [Thread-2 (]: 2 of 2 ERROR creating table model public.soma_vals_por_mes ............................................................. [[31mERROR[0m in 0.04s]
[0m18:07:52.877893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:52.878378 [debug] [Thread-2 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:07:52.880605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:07:52.880802 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:07:52.880965 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT DISTINCT mes_acporc AS mes
FROM tb_acporc
  );
[0m18:07:52.994764 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.11 seconds
[0m18:07:52.999452 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:07:52.999615 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
alter table "airbyte"."public"."dim_mes" rename to "dim_mes__dbt_backup"
[0m18:07:53.000734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:53.002767 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:07:53.002941 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
alter table "airbyte"."public"."dim_mes__dbt_tmp" rename to "dim_mes"
[0m18:07:53.003329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:53.020985 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:07:53.021161 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:07:53.021292 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:07:53.023084 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:07:53.026670 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:07:53.026820 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
drop table if exists "airbyte"."public"."dim_mes__dbt_backup" cascade
[0m18:07:53.030318 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:07:53.031573 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:53.031773 [debug] [Thread-1 (]: On model.postgres_test.dim_mes: Close
[0m18:07:53.032174 [info ] [Thread-1 (]: 1 of 2 OK created table model public.dim_mes ........................................................................... [[32mSELECT 13[0m in 0.20s]
[0m18:07:53.032558 [debug] [Thread-1 (]: Finished running node model.postgres_test.dim_mes
[0m18:07:53.033629 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:07:53.033793 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:53.033921 [debug] [MainThread]: On master: BEGIN
[0m18:07:53.034040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:53.035900 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:53.036116 [debug] [MainThread]: On master: COMMIT
[0m18:07:53.036246 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:53.036370 [debug] [MainThread]: On master: COMMIT
[0m18:07:53.036545 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:07:53.036686 [debug] [MainThread]: On master: Close
[0m18:07:53.037067 [info ] [MainThread]: 
[0m18:07:53.037595 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m18:07:53.037917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:53.038037 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:07:53.038152 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:07:53.042281 [info ] [MainThread]: 
[0m18:07:53.042551 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:07:53.042856 [info ] [MainThread]: 
[0m18:07:53.043082 [error] [MainThread]: [33mCompilation Error in model soma_vals_por_mes (models/example/soma_vals_por_mes.sql)[0m
[0m18:07:53.043301 [error] [MainThread]:   'str object' has no attribute 'information_schema'
[0m18:07:53.043552 [error] [MainThread]:   
[0m18:07:53.043883 [error] [MainThread]:   > in macro postgres__get_columns_in_relation (macros/adapters.sql)
[0m18:07:53.044123 [error] [MainThread]:   > called by macro get_columns_in_relation (macros/adapters/columns.sql)
[0m18:07:53.044348 [error] [MainThread]:   > called by macro statement (macros/etc/statement.sql)
[0m18:07:53.044549 [error] [MainThread]:   > called by model soma_vals_por_mes (models/example/soma_vals_por_mes.sql)
[0m18:07:53.044757 [info ] [MainThread]: 
[0m18:07:53.044969 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2


============================== 2022-08-03 18:08:51.551192 | 36a36ef7-afe8-4c36-9fa1-d492a66a848e ==============================
[0m18:08:51.551204 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:08:51.551560 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:08:51.551704 [debug] [MainThread]: Tracking: do not track
[0m18:08:51.574995 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 4 files added, 0 files changed.
[0m18:08:51.575307 [debug] [MainThread]: Partial parsing: added file: postgres_test://models/soma_vals_por_mes.sql
[0m18:08:51.575541 [debug] [MainThread]: Partial parsing: added file: postgres_test://models/schema.yml
[0m18:08:51.575731 [debug] [MainThread]: Partial parsing: added file: postgres_test://models/dim_mes.sql
[0m18:08:51.575928 [debug] [MainThread]: Partial parsing: added file: postgres_test://models/acporc.sql
[0m18:08:51.576142 [debug] [MainThread]: Partial parsing: deleted file: postgres_test://models/example/dim_mes.sql
[0m18:08:51.576287 [debug] [MainThread]: Partial parsing: deleted file: postgres_test://models/example/soma_vals_por_mes.sql
[0m18:08:51.585954 [debug] [MainThread]: 1603: static parser failed on soma_vals_por_mes.sql
[0m18:08:51.596849 [debug] [MainThread]: 1602: parser fallback to jinja rendering on soma_vals_por_mes.sql
[0m18:08:51.597729 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:08:51.600940 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:08:51.602271 [debug] [MainThread]: 1699: static parser successfully parsed acporc.sql
[0m18:08:51.613034 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:08:51.620803 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:08:51.621767 [info ] [MainThread]: 
[0m18:08:51.622139 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:08:51.622849 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:08:51.630152 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:08:51.630324 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:08:51.630450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:51.634360 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:08:51.635538 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:08:51.636479 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:08:51.641155 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:08:51.641331 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:08:51.641465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:51.643916 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:08:51.644301 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:08:51.644453 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:08:51.646760 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m18:08:51.648214 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:08:51.648528 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:08:51.652765 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:51.652948 [debug] [MainThread]: On master: BEGIN
[0m18:08:51.653077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:51.655368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:51.655531 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:51.655657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:08:51.657946 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:08:51.658796 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:51.659077 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:51.659219 [debug] [MainThread]: On master: BEGIN
[0m18:08:51.659655 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:51.659802 [debug] [MainThread]: On master: COMMIT
[0m18:08:51.659927 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:51.660046 [debug] [MainThread]: On master: COMMIT
[0m18:08:51.660302 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:08:51.660456 [debug] [MainThread]: On master: Close
[0m18:08:51.660777 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:08:51.661057 [info ] [MainThread]: 
[0m18:08:51.664179 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:08:51.664337 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:08:51.664641 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:08:51.664923 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:08:51.665363 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:08:51.665816 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:08:51.666040 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:08:51.666220 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:08:51.666395 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:08:51.666617 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:08:51.667722 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:08:51.669433 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:08:51.669989 [debug] [Thread-1 (]: finished collecting timing info
[0m18:08:51.670149 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:08:51.675502 [debug] [Thread-2 (]: finished collecting timing info
[0m18:08:51.680842 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:08:51.715645 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:08:51.717680 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:08:51.718273 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:08:51.718421 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:08:51.718555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:51.718867 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:08:51.719033 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:08:51.719167 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:08:51.720859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:08:51.721071 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:08:51.721215 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    SELECT *
FROM tb_acporc
  );
[0m18:08:51.721632 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:08:51.721801 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:08:51.721996 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT DISTINCT mes_acporc AS mes
FROM tb_acporc
  );
[0m18:08:51.727356 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:08:51.733351 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:08:51.733543 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:08:51.734018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:51.746320 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:08:51.746497 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:08:51.746663 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:08:51.748659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:08:51.752408 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:08:51.752577 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:08:51.752938 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:08:51.753780 [debug] [Thread-1 (]: finished collecting timing info
[0m18:08:51.753938 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:08:51.754520 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.09s]
[0m18:08:51.755187 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:08:51.755725 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:08:51.755941 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:08:51.756394 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:08:51.756533 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:08:51.756664 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:08:51.763601 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:08:51.763790 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:08:51.763920 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:08:51.766588 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:08:51.766906 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:08:51.767086 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:08:51.778437 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:08:51.782019 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:08:51.782234 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.06 seconds
[0m18:08:51.784679 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:08:51.784932 [debug] [Thread-4 (]: finished collecting timing info
[0m18:08:51.785106 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
alter table "airbyte"."public"."dim_mes" rename to "dim_mes__dbt_backup"
[0m18:08:51.785338 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:08:51.790195 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:08:51.790383 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:51.792222 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:08:51.792371 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
alter table "airbyte"."public"."dim_mes__dbt_tmp" rename to "dim_mes"
[0m18:08:51.792614 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:08:51.792779 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    

with vals as (
    select 
    
        SUM(<Column emp_cod (double precision)>) as SOMA_<Column emp_cod (double precision)>,
    
        SUM(<Column hdrcodetc (text)>) as SOMA_<Column hdrcodetc (text)>,
    
        SUM(<Column hdrcodpgr (text)>) as SOMA_<Column hdrcodpgr (text)>,
    
        SUM(<Column hdrcodusu (text)>) as SOMA_<Column hdrcodusu (text)>,
    
        SUM(<Column hdrdathor (text)>) as SOMA_<Column hdrdathor (text)>,
    
        SUM(<Column exe_acporc (double precision)>) as SOMA_<Column exe_acporc (double precision)>,
    
        SUM(<Column mes_acporc (double precision)>) as SOMA_<Column mes_acporc (double precision)>,
    
        SUM(<Column seq_acporc (double precision)>) as SOMA_<Column seq_acporc (double precision)>,
    
        SUM(<Column seq_ctaorc (double precision)>) as SOMA_<Column seq_ctaorc (double precision)>,
    
        SUM(<Column acpcodestcta (text)>) as SOMA_<Column acpcodestcta (text)>,
    
        SUM(<Column cresp_acporc (double precision)>) as SOMA_<Column cresp_acporc (double precision)>,
    
        SUM(<Column patroc_acporc (double precision)>) as SOMA_<Column patroc_acporc (double precision)>,
    
        SUM(<Column undctb_acporc (double precision)>) as SOMA_<Column undctb_acporc (double precision)>,
    
        SUM(<Column val_melhor_est (double precision)>) as SOMA_<Column val_melhor_est (double precision)>,
    
        SUM(<Column val_econ_parcial (double precision)>) as SOMA_<Column val_econ_parcial (double precision)>,
    
        SUM(<Column valprev_atu_acporc (double precision)>) as SOMA_<Column valprev_atu_acporc (double precision)>,
    
        SUM(<Column valprev_ini_acporc (double precision)>) as SOMA_<Column valprev_ini_acporc (double precision)>,
    
        SUM(<Column valreal_man_acporc (double precision)>) as SOMA_<Column valreal_man_acporc (double precision)>,
    
        SUM(<Column valreal_mis_acporc (double precision)>) as SOMA_<Column valreal_mis_acporc (double precision)>,
    
        SUM(<Column valprev_ver1_acporc (double precision)>) as SOMA_<Column valprev_ver1_acporc (double precision)>,
    
        SUM(<Column valprev_ver2_acporc (double precision)>) as SOMA_<Column valprev_ver2_acporc (double precision)>,
    
        SUM(<Column valprev_ver3_acporc (double precision)>) as SOMA_<Column valprev_ver3_acporc (double precision)>,
    
        SUM(<Column valprev_ver4_acporc (double precision)>) as SOMA_<Column valprev_ver4_acporc (double precision)>,
    
        SUM(<Column valprev_ver5_acporc (double precision)>) as SOMA_<Column valprev_ver5_acporc (double precision)>,
    
        SUM(<Column valprev_ver6_acporc (double precision)>) as SOMA_<Column valprev_ver6_acporc (double precision)>,
    
        SUM(<Column valreal_calc_acporc (double precision)>) as SOMA_<Column valreal_calc_acporc (double precision)>,
    
        SUM(<Column valrsrv_calc_acporc (double precision)>) as SOMA_<Column valrsrv_calc_acporc (double precision)>,
    
        SUM(<Column _airbyte_ab_id (character varying(256))>) as SOMA_<Column _airbyte_ab_id (character varying(256))>,
    
        SUM(<Column _airbyte_emitted_at (timestamp with time zone)>) as SOMA_<Column _airbyte_emitted_at (timestamp with time zone)>,
    
        SUM(<Column _airbyte_normalized_at (timestamp with time zone)>) as SOMA_<Column _airbyte_normalized_at (timestamp with time zone)>,
    
        SUM(<Column _airbyte_tb_acporc_hashid (text)>) as SOMA_<Column _airbyte_tb_acporc_hashid (text)>,
    
    MES_ACPORC
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:08:51.792941 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:51.798286 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "<"
LINE 11:         SUM(<Column emp_cod (double precision)>) as SOMA_<Co...
                     ^

[0m18:08:51.799363 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:08:51.799575 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: ROLLBACK
[0m18:08:51.799773 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:08:51.800152 [debug] [Thread-4 (]: finished collecting timing info
[0m18:08:51.800306 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:08:51.800519 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:08:51.800964 [debug] [Thread-4 (]: Database Error in model soma_vals_por_mes (models/soma_vals_por_mes.sql)
  syntax error at or near "<"
  LINE 11:         SUM(<Column emp_cod (double precision)>) as SOMA_<Co...
                       ^
  compiled SQL at target/run/postgres_test/models/soma_vals_por_mes.sql
[0m18:08:51.801455 [error] [Thread-4 (]: 3 of 3 ERROR creating table model public.soma_vals_por_mes ............................................................. [[31mERROR[0m in 0.05s]
[0m18:08:51.802073 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:08:51.802297 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:08:51.803930 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:08:51.804077 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
drop table if exists "airbyte"."public"."dim_mes__dbt_backup" cascade
[0m18:08:51.805268 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:08:51.806121 [debug] [Thread-2 (]: finished collecting timing info
[0m18:08:51.806282 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:08:51.806682 [info ] [Thread-2 (]: 2 of 3 OK created table model public.dim_mes ........................................................................... [[32mSELECT 13[0m in 0.14s]
[0m18:08:51.807070 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:08:51.808286 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:08:51.808463 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:51.808589 [debug] [MainThread]: On master: BEGIN
[0m18:08:51.808707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:51.810873 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:51.811049 [debug] [MainThread]: On master: COMMIT
[0m18:08:51.811188 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:51.811315 [debug] [MainThread]: On master: COMMIT
[0m18:08:51.811552 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:08:51.811697 [debug] [MainThread]: On master: Close
[0m18:08:51.812069 [info ] [MainThread]: 
[0m18:08:51.812370 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:08:51.812643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:51.812803 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:08:51.812927 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:08:51.813091 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:08:51.819301 [info ] [MainThread]: 
[0m18:08:51.819666 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:08:51.819918 [info ] [MainThread]: 
[0m18:08:51.820141 [error] [MainThread]: [33mDatabase Error in model soma_vals_por_mes (models/soma_vals_por_mes.sql)[0m
[0m18:08:51.820375 [error] [MainThread]:   syntax error at or near "<"
[0m18:08:51.820621 [error] [MainThread]:   LINE 11:         SUM(<Column emp_cod (double precision)>) as SOMA_<Co...
[0m18:08:51.820828 [error] [MainThread]:                        ^
[0m18:08:51.821034 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/soma_vals_por_mes.sql
[0m18:08:51.821250 [info ] [MainThread]: 
[0m18:08:51.821479 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:10:04.165405 | 930153bf-53c6-48e4-9d32-c62d41149a36 ==============================
[0m18:10:04.165414 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:10:04.165781 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:10:04.165917 [debug] [MainThread]: Tracking: do not track
[0m18:10:04.188442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:10:04.188847 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/soma_vals_por_mes.sql
[0m18:10:04.197694 [debug] [MainThread]: 1603: static parser failed on soma_vals_por_mes.sql


============================== 2022-08-03 18:11:17.752942 | e473b7fe-350c-4eb6-98c1-f868145fefb4 ==============================
[0m18:11:17.752951 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:11:17.753339 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:11:17.753474 [debug] [MainThread]: Tracking: do not track
[0m18:11:17.776431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:11:17.776818 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/soma_vals_por_mes.sql
[0m18:11:17.787031 [debug] [MainThread]: 1603: static parser failed on soma_vals_por_mes.sql
[0m18:11:17.798806 [debug] [MainThread]: 1602: parser fallback to jinja rendering on soma_vals_por_mes.sql
[0m18:11:17.808122 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:11:17.818407 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:11:17.820032 [info ] [MainThread]: 
[0m18:11:17.820676 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:11:17.821352 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:11:17.828525 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:11:17.828680 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:11:17.828809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:17.832720 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:11:17.833642 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:11:17.834637 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:11:17.838896 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:11:17.839048 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:11:17.839176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:17.841510 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:11:17.841669 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:11:17.841823 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:11:17.843902 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.0 seconds
[0m18:11:17.845302 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:11:17.845689 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:11:17.851113 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:17.851312 [debug] [MainThread]: On master: BEGIN
[0m18:11:17.851441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:17.853784 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:17.853950 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:17.854076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:11:17.861562 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:11:17.862569 [debug] [MainThread]: On master: ROLLBACK
[0m18:11:17.862867 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:17.863052 [debug] [MainThread]: On master: BEGIN
[0m18:11:17.863456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:17.863609 [debug] [MainThread]: On master: COMMIT
[0m18:11:17.863739 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:17.863862 [debug] [MainThread]: On master: COMMIT
[0m18:11:17.864117 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:11:17.864276 [debug] [MainThread]: On master: Close
[0m18:11:17.864572 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:11:17.864826 [info ] [MainThread]: 
[0m18:11:17.867709 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:11:17.867897 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:11:17.868115 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:11:17.868408 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:11:17.868823 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:11:17.869154 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:11:17.869407 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:11:17.869608 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:11:17.869764 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:11:17.870907 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:11:17.871064 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:11:17.872837 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:11:17.873003 [debug] [Thread-1 (]: finished collecting timing info
[0m18:11:17.873226 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:11:17.898967 [debug] [Thread-2 (]: finished collecting timing info
[0m18:11:17.903649 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:11:17.903848 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:11:17.920015 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:11:17.920255 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:11:17.920503 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:11:17.920721 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:11:17.920905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:17.921068 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:11:17.921404 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:11:17.923563 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:11:17.923776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:11:17.923930 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:11:17.924132 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:11:17.924322 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT DISTINCT mes_acporc AS mes
FROM tb_acporc
  );
[0m18:11:17.924484 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    SELECT *
FROM tb_acporc
  );
[0m18:11:17.927115 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:17.931978 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:11:17.932165 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:11:17.932685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:17.935338 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:11:17.935504 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:11:17.935986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:17.950413 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:11:17.950621 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:11:17.950774 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:11:17.953698 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:11:17.957264 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:11:17.957430 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:11:17.960364 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:17.961207 [debug] [Thread-1 (]: finished collecting timing info
[0m18:11:17.961374 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:11:17.961851 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.09s]
[0m18:11:17.962361 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:11:17.962876 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:11:17.963333 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:11:17.964065 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:11:17.964350 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:11:17.964625 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:11:17.979744 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:11:17.980092 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:11:17.980371 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:11:17.982873 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:11:17.983210 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:11:17.983562 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:11:17.986668 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.06 seconds
[0m18:11:17.988638 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:11:17.988818 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
alter table "airbyte"."public"."dim_mes" rename to "dim_mes__dbt_backup"
[0m18:11:17.989226 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:17.991340 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:11:17.991592 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:11:17.991807 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
alter table "airbyte"."public"."dim_mes__dbt_tmp" rename to "dim_mes"
[0m18:11:17.995400 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:11:17.996403 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:18.001329 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:11:18.001587 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:11:18.001798 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:11:18.001966 [debug] [Thread-4 (]: finished collecting timing info
[0m18:11:18.002129 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:11:18.006083 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:11:18.006367 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:11:18.007677 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:11:18.007819 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
drop table if exists "airbyte"."public"."dim_mes__dbt_backup" cascade
[0m18:11:18.008011 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:11:18.008196 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    

with vals as (
    select 
    
        SUM(val_melhor_est) as SOMA_val_melhor_est,
    
        SUM(val_econ_parcial) as SOMA_val_econ_parcial,
    
        SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc,
    
        SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc,
    
        SUM(valreal_man_acporc) as SOMA_valreal_man_acporc,
    
        SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc,
    
        SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc,
    
        SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc,
    
        SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc,
    
        SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc,
    
        SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc,
    
        SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc,
    
        SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc,
    
        SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc,
    
    MES_ACPORC
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:11:18.009561 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:11:18.010440 [debug] [Thread-2 (]: finished collecting timing info
[0m18:11:18.010597 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:11:18.011055 [info ] [Thread-2 (]: 2 of 3 OK created table model public.dim_mes ........................................................................... [[32mSELECT 13[0m in 0.14s]
[0m18:11:18.011470 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:11:18.052906 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:11:18.054876 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:11:18.055026 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:11:18.055354 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:18.056908 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:11:18.057051 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:11:18.057178 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:11:18.058929 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:11:18.061272 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:11:18.061414 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:11:18.061664 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:11:18.062472 [debug] [Thread-4 (]: finished collecting timing info
[0m18:11:18.062626 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:11:18.063213 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.10s]
[0m18:11:18.063842 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:11:18.065363 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:11:18.065528 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:18.065658 [debug] [MainThread]: On master: BEGIN
[0m18:11:18.065776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:18.067778 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:18.067955 [debug] [MainThread]: On master: COMMIT
[0m18:11:18.068095 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:18.068228 [debug] [MainThread]: On master: COMMIT
[0m18:11:18.068452 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:11:18.068598 [debug] [MainThread]: On master: Close
[0m18:11:18.068911 [info ] [MainThread]: 
[0m18:11:18.069165 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m18:11:18.069448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:18.069573 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:11:18.069698 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:11:18.069820 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:11:18.074002 [info ] [MainThread]: 
[0m18:11:18.074267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:18.074566 [info ] [MainThread]: 
[0m18:11:18.074816 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3


============================== 2022-08-03 18:12:50.898654 | bae9e4ea-782b-4548-a5b7-cd37befd75b7 ==============================
[0m18:12:50.898664 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:12:50.898990 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:12:50.899161 [debug] [MainThread]: Tracking: do not track
[0m18:12:50.921627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:12:50.921974 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/soma_vals_por_mes.sql
[0m18:12:50.930649 [debug] [MainThread]: 1603: static parser failed on soma_vals_por_mes.sql
[0m18:12:50.942884 [debug] [MainThread]: 1602: parser fallback to jinja rendering on soma_vals_por_mes.sql
[0m18:12:50.952156 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:12:50.960385 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:12:50.961371 [info ] [MainThread]: 
[0m18:12:50.961806 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:12:50.962889 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:12:50.970787 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:12:50.971000 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:12:50.971132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:50.974712 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:12:50.975834 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:12:50.976885 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:12:50.981301 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:12:50.981551 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:12:50.981690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:50.983918 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:12:50.984100 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:12:50.984237 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:12:50.986166 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:12:50.987608 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:12:50.987905 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:12:50.993535 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:50.993873 [debug] [MainThread]: On master: BEGIN
[0m18:12:50.994048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:50.996477 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:12:50.996639 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:50.996774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:12:51.002340 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:12:51.003365 [debug] [MainThread]: On master: ROLLBACK
[0m18:12:51.003612 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:51.003755 [debug] [MainThread]: On master: BEGIN
[0m18:12:51.004120 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:12:51.004267 [debug] [MainThread]: On master: COMMIT
[0m18:12:51.004402 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:51.004529 [debug] [MainThread]: On master: COMMIT
[0m18:12:51.004758 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:12:51.004911 [debug] [MainThread]: On master: Close
[0m18:12:51.005213 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:12:51.005463 [info ] [MainThread]: 
[0m18:12:51.008735 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:12:51.008951 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:12:51.009176 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:12:51.009478 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:12:51.009927 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:12:51.010321 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:12:51.010521 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:12:51.010677 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:12:51.010833 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:12:51.011035 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:12:51.012167 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:12:51.013883 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:12:51.014268 [debug] [Thread-2 (]: finished collecting timing info
[0m18:12:51.014394 [debug] [Thread-1 (]: finished collecting timing info
[0m18:12:51.014606 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:12:51.014838 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:12:51.056313 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:12:51.060814 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:12:51.061315 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:12:51.061456 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:12:51.061579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:51.061846 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:12:51.062024 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:12:51.062149 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:12:51.063745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:12:51.063935 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:12:51.064086 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    SELECT *
FROM tb_acporc
  );
[0m18:12:51.064469 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:12:51.064644 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:12:51.064773 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT DISTINCT mes_acporc AS mes
FROM tb_acporc
  );
[0m18:12:51.066258 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:12:51.070978 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:12:51.071147 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:12:51.071565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:12:51.073324 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:12:51.073470 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:12:51.073843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:12:51.089223 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:12:51.089471 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:12:51.089610 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:12:51.091661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:12:51.095451 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:12:51.095609 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:12:51.096734 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:12:51.097569 [debug] [Thread-1 (]: finished collecting timing info
[0m18:12:51.097797 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:12:51.098397 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.09s]
[0m18:12:51.099095 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:12:51.099681 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:12:51.099970 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:12:51.100455 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:12:51.100635 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:12:51.100847 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:12:51.108200 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:12:51.108427 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:12:51.108591 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:12:51.111163 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:12:51.111526 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:12:51.111812 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:12:51.118604 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:12:51.124985 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:12:51.125300 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.06 seconds
[0m18:12:51.127395 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:12:51.127618 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
alter table "airbyte"."public"."dim_mes" rename to "dim_mes__dbt_backup"
[0m18:12:51.127900 [debug] [Thread-4 (]: finished collecting timing info
[0m18:12:51.128187 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:12:51.132470 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:12:51.132914 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m18:12:51.134820 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:12:51.134994 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
alter table "airbyte"."public"."dim_mes__dbt_tmp" rename to "dim_mes"
[0m18:12:51.135537 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:12:51.135838 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    

with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:12:51.136043 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:12:51.145901 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:12:51.146293 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:12:51.146583 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:12:51.148345 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:12:51.151427 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:12:51.151731 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
drop table if exists "airbyte"."public"."dim_mes__dbt_backup" cascade
[0m18:12:51.154292 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:12:51.155817 [debug] [Thread-2 (]: finished collecting timing info
[0m18:12:51.156152 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:12:51.156834 [info ] [Thread-2 (]: 2 of 3 OK created table model public.dim_mes ........................................................................... [[32mSELECT 13[0m in 0.15s]
[0m18:12:51.157547 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:12:51.179168 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:12:51.181404 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:12:51.181562 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:12:51.181959 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:12:51.183862 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:12:51.184087 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:12:51.184427 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:12:51.186676 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:12:51.186892 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:12:51.187030 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:12:51.187926 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:12:51.191770 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:12:51.191957 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:12:51.194381 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:12:51.195204 [debug] [Thread-4 (]: finished collecting timing info
[0m18:12:51.195367 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:12:51.195749 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.10s]
[0m18:12:51.196123 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:12:51.197250 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:12:51.197423 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:51.197560 [debug] [MainThread]: On master: BEGIN
[0m18:12:51.197697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:51.199936 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:12:51.200113 [debug] [MainThread]: On master: COMMIT
[0m18:12:51.200246 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:51.200368 [debug] [MainThread]: On master: COMMIT
[0m18:12:51.200614 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:12:51.200772 [debug] [MainThread]: On master: Close
[0m18:12:51.201090 [info ] [MainThread]: 
[0m18:12:51.201339 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m18:12:51.201563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:51.201689 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:12:51.201820 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:12:51.201944 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:12:51.205840 [info ] [MainThread]: 
[0m18:12:51.206137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:51.206397 [info ] [MainThread]: 
[0m18:12:51.206617 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3


============================== 2022-08-03 18:17:45.805799 | a89754ab-f11d-44bd-ab6f-0ecb931f269d ==============================
[0m18:17:45.805809 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:17:45.806206 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:17:45.806368 [debug] [MainThread]: Tracking: do not track
[0m18:17:45.829855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m18:17:45.830233 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/soma_vals_por_mes.sql
[0m18:17:45.830496 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:17:45.830764 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/acporc.sql
[0m18:17:45.840227 [debug] [MainThread]: 1603: static parser failed on soma_vals_por_mes.sql
[0m18:17:45.851490 [debug] [MainThread]: 1602: parser fallback to jinja rendering on soma_vals_por_mes.sql
[0m18:17:45.852426 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:17:45.855799 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:17:45.857261 [debug] [MainThread]: 1699: static parser successfully parsed acporc.sql
[0m18:17:45.868000 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:17:45.875927 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:17:45.877246 [info ] [MainThread]: 
[0m18:17:45.877621 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:17:45.878274 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:17:45.886177 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:17:45.886366 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:17:45.886511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:45.890056 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:17:45.890970 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:17:45.891900 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:17:45.896239 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:17:45.896540 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:17:45.896698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:45.899587 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:17:45.900008 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:17:45.900184 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:17:45.902505 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:17:45.904099 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:17:45.904355 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:17:45.908103 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:45.908265 [debug] [MainThread]: On master: BEGIN
[0m18:17:45.908395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:45.910691 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:45.910860 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:45.910999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:17:45.916616 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:17:45.917568 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:45.917833 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:45.917979 [debug] [MainThread]: On master: BEGIN
[0m18:17:45.918347 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:45.918495 [debug] [MainThread]: On master: COMMIT
[0m18:17:45.918629 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:45.918757 [debug] [MainThread]: On master: COMMIT
[0m18:17:45.918989 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:45.919145 [debug] [MainThread]: On master: Close
[0m18:17:45.919523 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:17:45.919785 [info ] [MainThread]: 
[0m18:17:45.922914 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:17:45.923150 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:17:45.923540 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:17:45.923684 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:17:45.923833 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:17:45.924878 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:17:45.925137 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:17:45.925396 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:17:45.925526 [debug] [Thread-1 (]: finished collecting timing info
[0m18:17:45.926072 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:17:45.926252 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:17:45.926550 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:17:45.947326 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:17:45.954740 [debug] [Thread-2 (]: finished collecting timing info
[0m18:17:45.959651 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:17:45.960064 [debug] [Thread-2 (]: Compilation Error in model dim_mes (models/dim_mes.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:17:45.960568 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.03s]
[0m18:17:45.960943 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:17:45.961411 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:17:45.961559 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:17:45.961685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:45.964699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:45.964928 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:17:45.965106 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:17:45.969512 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:17:45.974340 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:17:45.974514 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:17:45.975001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:45.977689 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:17:45.977838 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:17:45.978291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:45.992601 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:17:45.992910 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:17:45.993079 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:17:45.995909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:45.999739 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:17:45.999906 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:17:46.002344 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:17:46.003297 [debug] [Thread-1 (]: finished collecting timing info
[0m18:17:46.003467 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:17:46.003885 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.08s]
[0m18:17:46.004240 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:17:46.004695 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:17:46.004913 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:17:46.005524 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:17:46.005670 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:17:46.005806 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:17:46.013122 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:17:46.013302 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:17:46.013426 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:17:46.015638 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:46.015808 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:17:46.015989 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:17:46.022219 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:17:46.026441 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:17:46.026896 [debug] [Thread-4 (]: finished collecting timing info
[0m18:17:46.027067 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:17:46.045712 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:17:46.046131 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:17:46.046276 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:17:46.085133 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:17:46.087232 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:17:46.087384 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:17:46.087779 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:46.089441 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:17:46.089583 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:17:46.089912 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:46.094368 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:17:46.094518 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:17:46.094645 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:17:46.096570 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:46.098111 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:17:46.098259 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:17:46.100706 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:46.101707 [debug] [Thread-4 (]: finished collecting timing info
[0m18:17:46.101892 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:17:46.102344 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.10s]
[0m18:17:46.102813 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:17:46.103975 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:17:46.104149 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:46.104278 [debug] [MainThread]: On master: BEGIN
[0m18:17:46.104399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:46.106590 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:46.106759 [debug] [MainThread]: On master: COMMIT
[0m18:17:46.106888 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:46.107009 [debug] [MainThread]: On master: COMMIT
[0m18:17:46.107255 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:46.107409 [debug] [MainThread]: On master: Close
[0m18:17:46.107788 [info ] [MainThread]: 
[0m18:17:46.108062 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:17:46.108315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:46.108433 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:17:46.108548 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:17:46.108660 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:17:46.113694 [info ] [MainThread]: 
[0m18:17:46.113967 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:17:46.114245 [info ] [MainThread]: 
[0m18:17:46.114543 [error] [MainThread]: [33mCompilation Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:17:46.114801 [error] [MainThread]:   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:17:46.115105 [info ] [MainThread]: 
[0m18:17:46.115315 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:18:27.429851 | 21e0f41b-1e6c-46db-8460-804f76da3ac4 ==============================
[0m18:18:27.429862 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:18:27.430203 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:18:27.430369 [debug] [MainThread]: Tracking: do not track
[0m18:18:27.453848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:18:27.454366 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:18:27.463764 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql


============================== 2022-08-03 18:18:40.194836 | d2b8adda-72b8-4b2b-abc0-7d5bc0963a35 ==============================
[0m18:18:40.194846 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:18:40.195159 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:18:40.195303 [debug] [MainThread]: Tracking: do not track
[0m18:18:40.218085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:18:40.218507 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:18:40.227396 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:18:40.238562 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:18:40.248645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:18:40.257872 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:18:40.259048 [info ] [MainThread]: 
[0m18:18:40.260065 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:18:40.260860 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:18:40.268663 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:18:40.268886 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:18:40.269072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:40.275052 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:18:40.276193 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:18:40.277333 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:18:40.281924 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:18:40.282104 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:18:40.282240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:40.284770 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:18:40.285064 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:18:40.285275 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:18:40.288098 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:18:40.289936 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:18:40.290734 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:18:40.297126 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:40.297438 [debug] [MainThread]: On master: BEGIN
[0m18:18:40.297603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:40.299869 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:40.300110 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:40.300278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:18:40.306327 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:18:40.307419 [debug] [MainThread]: On master: ROLLBACK
[0m18:18:40.307681 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:40.307841 [debug] [MainThread]: On master: BEGIN
[0m18:18:40.308123 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:40.308302 [debug] [MainThread]: On master: COMMIT
[0m18:18:40.308430 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:40.308552 [debug] [MainThread]: On master: COMMIT
[0m18:18:40.308744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:18:40.308916 [debug] [MainThread]: On master: Close
[0m18:18:40.309356 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:18:40.310021 [info ] [MainThread]: 
[0m18:18:40.313420 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:18:40.313588 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:18:40.313860 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:18:40.314104 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:18:40.314628 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:18:40.315138 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:18:40.315367 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:18:40.315615 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:18:40.315839 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:18:40.316099 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:18:40.317490 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:18:40.321188 [debug] [Thread-2 (]: finished collecting timing info
[0m18:18:40.321842 [debug] [Thread-2 (]: Compilation Error in model dim_mes (models/dim_mes.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:18:40.322308 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.01s]
[0m18:18:40.323125 [debug] [Thread-1 (]: finished collecting timing info
[0m18:18:40.323936 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:18:40.324392 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:18:40.357383 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:18:40.357755 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:18:40.357903 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:18:40.358027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:40.360372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:40.360668 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:18:40.360802 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:18:40.363467 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:18:40.368206 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:18:40.368401 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:18:40.368857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:40.370629 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:18:40.370775 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:18:40.371236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:40.386218 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:18:40.386412 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:18:40.386561 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:18:40.388318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:40.392857 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:18:40.393019 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:18:40.395487 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:18:40.398309 [debug] [Thread-1 (]: finished collecting timing info
[0m18:18:40.398834 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:18:40.400446 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.09s]
[0m18:18:40.402009 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:18:40.402943 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:18:40.403919 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:18:40.404858 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:18:40.405201 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:18:40.405498 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:18:40.418050 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:18:40.418306 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:18:40.418501 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:18:40.421225 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:40.421612 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:18:40.421829 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:18:40.429916 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:18:40.434384 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:18:40.435111 [debug] [Thread-4 (]: finished collecting timing info
[0m18:18:40.435319 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:18:40.451412 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:18:40.451759 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:18:40.451897 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:18:40.491553 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:18:40.493632 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:18:40.493783 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:18:40.494167 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:40.495755 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:18:40.495893 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:18:40.496240 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:40.500635 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:18:40.500835 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:18:40.501005 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:18:40.503181 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:40.504618 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:18:40.504761 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:18:40.506134 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:18:40.507068 [debug] [Thread-4 (]: finished collecting timing info
[0m18:18:40.507229 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:18:40.507669 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.10s]
[0m18:18:40.508070 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:18:40.509239 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:18:40.509460 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:40.509586 [debug] [MainThread]: On master: BEGIN
[0m18:18:40.509705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:18:40.511744 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:40.512008 [debug] [MainThread]: On master: COMMIT
[0m18:18:40.512201 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:40.512331 [debug] [MainThread]: On master: COMMIT
[0m18:18:40.512560 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:18:40.512754 [debug] [MainThread]: On master: Close
[0m18:18:40.513063 [info ] [MainThread]: 
[0m18:18:40.513311 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m18:18:40.513541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:40.513661 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:18:40.513782 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:18:40.513902 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:18:40.517934 [info ] [MainThread]: 
[0m18:18:40.518208 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:18:40.518466 [info ] [MainThread]: 
[0m18:18:40.518691 [error] [MainThread]: [33mCompilation Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:18:40.518911 [error] [MainThread]:   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:18:40.519156 [info ] [MainThread]: 
[0m18:18:40.519412 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:19:18.330417 | 57608d11-3feb-43d6-94a3-13fb31aa76d6 ==============================
[0m18:19:18.330427 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:19:18.330762 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:19:18.330936 [debug] [MainThread]: Tracking: do not track
[0m18:19:18.353078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:19:18.353694 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:19:18.362305 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:19:18.372755 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:19:18.381889 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:19:18.390543 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:19:18.391641 [info ] [MainThread]: 
[0m18:19:18.392096 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:19:18.392949 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:19:18.401191 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:19:18.401386 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:19:18.401519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:18.408746 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:19:18.409799 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:19:18.410763 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:19:18.415309 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:19:18.415467 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:19:18.415625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:18.418006 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:19:18.418180 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:19:18.418312 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:19:18.420493 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:19:18.422211 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:19:18.422581 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:19:18.427931 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:18.428132 [debug] [MainThread]: On master: BEGIN
[0m18:19:18.428264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:18.430548 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:18.430714 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:18.430845 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:19:18.436368 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:19:18.437340 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:18.437593 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:18.437738 [debug] [MainThread]: On master: BEGIN
[0m18:19:18.438126 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:18.438274 [debug] [MainThread]: On master: COMMIT
[0m18:19:18.438436 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:18.438620 [debug] [MainThread]: On master: COMMIT
[0m18:19:18.438936 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:19:18.439099 [debug] [MainThread]: On master: Close
[0m18:19:18.439434 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:19:18.439685 [info ] [MainThread]: 
[0m18:19:18.442756 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:19:18.442987 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:19:18.443361 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:19:18.443503 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:19:18.443637 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:19:18.444709 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:19:18.445012 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:19:18.445411 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:19:18.445577 [debug] [Thread-1 (]: finished collecting timing info
[0m18:19:18.446027 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:19:18.446222 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:19:18.446381 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:19:18.451845 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:19:18.469135 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:19:18.479039 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:19:18.479575 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:18.479716 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:19:18.479849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:18.480122 [debug] [Thread-2 (]: finished collecting timing info
[0m18:19:18.480328 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:19:18.492320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:19:18.496948 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:19:18.497164 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:18.497465 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:19:18.497734 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:19:18.497877 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:19:18.498009 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:19:18.500281 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:19:18.500491 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:19:18.500652 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT 
md5(mes_acporc) as mes_id,
mes_acporc
GROUP BY mes_acporc
FROM tb_acporc
  );
[0m18:19:18.500875 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:19:18.505748 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:18.505925 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 12: FROM tb_acporc
         ^

[0m18:19:18.506205 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:19:18.506403 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: ROLLBACK
[0m18:19:18.506938 [debug] [Thread-2 (]: finished collecting timing info
[0m18:19:18.507061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:18.507276 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:19:18.509950 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:18.510461 [debug] [Thread-2 (]: Database Error in model dim_mes (models/dim_mes.sql)
  syntax error at or near "FROM"
  LINE 12: FROM tb_acporc
           ^
  compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:19:18.510772 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:19:18.511160 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.07s]
[0m18:19:18.511876 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:19:18.512135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:18.527325 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:19:18.527568 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:18.527740 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:19:18.529771 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:19:18.533526 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:18.533682 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:19:18.536029 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:19:18.536862 [debug] [Thread-1 (]: finished collecting timing info
[0m18:19:18.537026 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:19:18.537409 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.09s]
[0m18:19:18.537854 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:19:18.538519 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:19:18.538796 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:19:18.539247 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:18.539426 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:19:18.539584 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:19:18.547774 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:18.547974 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:19:18.548113 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:19:18.550570 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:19:18.550751 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:18.550922 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:19:18.557000 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:19:18.561823 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:19:18.562277 [debug] [Thread-4 (]: finished collecting timing info
[0m18:19:18.562515 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:19:18.568606 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:19:18.569146 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:18.569387 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:19:18.678677 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.11 seconds
[0m18:19:18.681411 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:18.681619 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:19:18.682063 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:18.684236 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:18.684413 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:19:18.684745 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:18.690102 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:19:18.690271 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:18.690415 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:19:18.692384 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:19:18.693853 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:18.693993 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:19:18.695264 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:19:18.696118 [debug] [Thread-4 (]: finished collecting timing info
[0m18:19:18.696276 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:19:18.696780 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.16s]
[0m18:19:18.697450 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:19:18.698779 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:19:18.698970 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:18.699116 [debug] [MainThread]: On master: BEGIN
[0m18:19:18.699259 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:18.701318 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:18.701478 [debug] [MainThread]: On master: COMMIT
[0m18:19:18.701606 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:18.701727 [debug] [MainThread]: On master: COMMIT
[0m18:19:18.701965 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:19:18.702120 [debug] [MainThread]: On master: Close
[0m18:19:18.702427 [info ] [MainThread]: 
[0m18:19:18.702738 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m18:19:18.702998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:18.703166 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:19:18.703286 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:19:18.703400 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:19:18.707421 [info ] [MainThread]: 
[0m18:19:18.707691 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:19:18.708083 [info ] [MainThread]: 
[0m18:19:18.708446 [error] [MainThread]: [33mDatabase Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:19:18.708806 [error] [MainThread]:   syntax error at or near "FROM"
[0m18:19:18.709172 [error] [MainThread]:   LINE 12: FROM tb_acporc
[0m18:19:18.709474 [error] [MainThread]:            ^
[0m18:19:18.709796 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:19:18.710034 [info ] [MainThread]: 
[0m18:19:18.710261 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:19:35.960415 | f6b95b53-8ebe-47da-bbae-86f52e59f099 ==============================
[0m18:19:35.960425 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:19:35.960763 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:19:35.960936 [debug] [MainThread]: Tracking: do not track
[0m18:19:35.983205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:19:35.983565 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:19:35.992104 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:19:36.003221 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:19:36.012373 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:19:36.021358 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:19:36.022363 [info ] [MainThread]: 
[0m18:19:36.022879 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:19:36.023639 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:19:36.031694 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:19:36.031931 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:19:36.032074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:36.035633 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:19:36.036598 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:19:36.037469 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:19:36.041910 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:19:36.042066 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:19:36.042193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:36.044462 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:19:36.044631 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:19:36.044759 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:19:36.046676 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:19:36.048045 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:19:36.048331 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:19:36.053141 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:36.053351 [debug] [MainThread]: On master: BEGIN
[0m18:19:36.053486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:36.056835 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:36.057041 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:36.057171 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:19:36.062764 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:19:36.063695 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:36.063974 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:36.064130 [debug] [MainThread]: On master: BEGIN
[0m18:19:36.064532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:36.064685 [debug] [MainThread]: On master: COMMIT
[0m18:19:36.064817 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:36.064970 [debug] [MainThread]: On master: COMMIT
[0m18:19:36.065305 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:19:36.065491 [debug] [MainThread]: On master: Close
[0m18:19:36.065784 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:19:36.066086 [info ] [MainThread]: 
[0m18:19:36.069287 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:19:36.069461 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:19:36.069705 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:19:36.069962 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:19:36.070372 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:19:36.070780 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:19:36.070967 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:19:36.071131 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:19:36.071322 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:19:36.071463 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:19:36.072570 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:19:36.074278 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:19:36.074672 [debug] [Thread-1 (]: finished collecting timing info
[0m18:19:36.074872 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:19:36.085342 [debug] [Thread-2 (]: finished collecting timing info
[0m18:19:36.090786 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:19:36.104856 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:19:36.120939 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:19:36.121274 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:36.121432 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:19:36.121622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:36.121862 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:19:36.122211 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:19:36.122371 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:19:36.124355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:19:36.124605 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:19:36.124770 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:36.124926 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:19:36.125154 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:19:36.125341 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT 
md5(mes_acporc) as mes_id,
mes_acporc
FROM tb_acporc
GROUP BY mes_acporc
  );
[0m18:19:36.126582 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function md5(double precision) does not exist
LINE 9: md5(mes_acporc) as mes_id,
        ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:19:36.126757 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: ROLLBACK
[0m18:19:36.127165 [debug] [Thread-2 (]: finished collecting timing info
[0m18:19:36.127461 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:19:36.127855 [debug] [Thread-2 (]: Database Error in model dim_mes (models/dim_mes.sql)
  function md5(double precision) does not exist
  LINE 9: md5(mes_acporc) as mes_id,
          ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:19:36.128348 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.06s]
[0m18:19:36.128773 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:19:36.129107 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:19:36.133762 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:36.133926 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:19:36.134404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:36.136924 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:36.137071 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:19:36.137528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:36.151948 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:19:36.152139 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:36.152268 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:19:36.154187 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:19:36.158176 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:19:36.158381 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:19:36.161331 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:19:36.162371 [debug] [Thread-1 (]: finished collecting timing info
[0m18:19:36.162598 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:19:36.163120 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.09s]
[0m18:19:36.163535 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:19:36.164412 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:19:36.164662 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:19:36.165234 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:36.165451 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:19:36.165592 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:19:36.172874 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:36.173047 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:19:36.173178 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:19:36.175447 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:19:36.175616 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:36.175750 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:19:36.181694 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:19:36.185244 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:19:36.185689 [debug] [Thread-4 (]: finished collecting timing info
[0m18:19:36.185856 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:19:36.190115 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:19:36.190866 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:36.191035 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:19:36.230627 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:19:36.232807 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:36.232967 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:19:36.233379 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:36.235042 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:36.235185 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:19:36.235542 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:36.240253 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:19:36.240413 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:36.240553 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:19:36.242569 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:19:36.243971 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:19:36.244113 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:19:36.245477 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:19:36.246304 [debug] [Thread-4 (]: finished collecting timing info
[0m18:19:36.246467 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:19:36.246862 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.08s]
[0m18:19:36.247219 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:19:36.248406 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:19:36.248578 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:36.248707 [debug] [MainThread]: On master: BEGIN
[0m18:19:36.248825 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:36.250878 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:36.251044 [debug] [MainThread]: On master: COMMIT
[0m18:19:36.251213 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:36.251407 [debug] [MainThread]: On master: COMMIT
[0m18:19:36.251642 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:19:36.251780 [debug] [MainThread]: On master: Close
[0m18:19:36.252153 [info ] [MainThread]: 
[0m18:19:36.252431 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:19:36.252694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:36.252811 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:19:36.252953 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:19:36.253062 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:19:36.257126 [info ] [MainThread]: 
[0m18:19:36.257379 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:19:36.257664 [info ] [MainThread]: 
[0m18:19:36.257880 [error] [MainThread]: [33mDatabase Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:19:36.258093 [error] [MainThread]:   function md5(double precision) does not exist
[0m18:19:36.258296 [error] [MainThread]:   LINE 9: md5(mes_acporc) as mes_id,
[0m18:19:36.258527 [error] [MainThread]:           ^
[0m18:19:36.258746 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m18:19:36.258960 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:19:36.259189 [info ] [MainThread]: 
[0m18:19:36.259463 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:20:31.128803 | 11aae7e6-cd42-483a-ac22-8d8dc25ab93f ==============================
[0m18:20:31.128813 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:20:31.129181 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:20:31.129344 [debug] [MainThread]: Tracking: do not track
[0m18:20:31.151913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:20:31.152287 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:20:31.161935 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql


============================== 2022-08-03 18:20:40.125533 | 47e7cc0f-31f0-4e28-9ec6-48755ca748dc ==============================
[0m18:20:40.125544 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:20:40.125904 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:20:40.126093 [debug] [MainThread]: Tracking: do not track
[0m18:20:40.150013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:20:40.150398 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:20:40.160171 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:20:40.170785 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:20:40.180482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:20:40.190010 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:20:40.191254 [info ] [MainThread]: 
[0m18:20:40.191946 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:20:40.192867 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:20:40.199936 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:20:40.200089 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:20:40.200215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:40.205400 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:20:40.206429 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:20:40.207448 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:20:40.211758 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:20:40.211916 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:20:40.212044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:20:40.214447 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:20:40.214673 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:20:40.214806 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:20:40.216775 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:20:40.218456 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:20:40.219005 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:20:40.223811 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:40.224062 [debug] [MainThread]: On master: BEGIN
[0m18:20:40.224255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:40.227293 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:20:40.227470 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:40.227602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:20:40.233077 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:20:40.233998 [debug] [MainThread]: On master: ROLLBACK
[0m18:20:40.234257 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:40.234402 [debug] [MainThread]: On master: BEGIN
[0m18:20:40.234776 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:20:40.234925 [debug] [MainThread]: On master: COMMIT
[0m18:20:40.235051 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:40.235170 [debug] [MainThread]: On master: COMMIT
[0m18:20:40.235411 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:20:40.235565 [debug] [MainThread]: On master: Close
[0m18:20:40.235850 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:20:40.236163 [info ] [MainThread]: 
[0m18:20:40.239482 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:20:40.239805 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:20:40.240129 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:20:40.240386 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:20:40.240864 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:20:40.241361 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:20:40.241566 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:20:40.241755 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:20:40.241986 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:20:40.242171 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:20:40.243334 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:20:40.246244 [debug] [Thread-2 (]: finished collecting timing info
[0m18:20:40.246416 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.246809 [debug] [Thread-2 (]: Compilation Error in model dim_mes (models/dim_mes.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:20:40.247007 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:20:40.247361 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.01s]
[0m18:20:40.263148 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:20:40.277544 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:20:40.277934 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:20:40.278082 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:20:40.278205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:40.281271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:20:40.281708 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:20:40.281929 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:20:40.283940 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:20:40.288594 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:20:40.288757 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:20:40.289215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:40.291092 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:20:40.291236 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:20:40.291637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:40.305731 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:20:40.305913 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:20:40.306108 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:20:40.307984 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:20:40.312363 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:20:40.312533 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:20:40.314903 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:20:40.315727 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.315884 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:20:40.316358 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.08s]
[0m18:20:40.316704 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:20:40.317327 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:20:40.317539 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:20:40.317947 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:20:40.318085 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:20:40.318217 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:20:40.325665 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:20:40.325839 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:20:40.326008 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:20:40.328384 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:20:40.328601 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:20:40.328778 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:20:40.335127 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:20:40.338706 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:20:40.339025 [debug] [Thread-4 (]: finished collecting timing info
[0m18:20:40.339203 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:20:40.356764 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:20:40.357118 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:20:40.357256 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:20:40.396231 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:20:40.398341 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:20:40.398490 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:20:40.398862 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:40.400471 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:20:40.400612 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:20:40.400927 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:40.405391 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:20:40.405538 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:20:40.405664 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:20:40.407787 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:20:40.409469 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:20:40.409638 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:20:40.411148 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:20:40.412149 [debug] [Thread-4 (]: finished collecting timing info
[0m18:20:40.412336 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:20:40.412776 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.09s]
[0m18:20:40.413117 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:20:40.414254 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:20:40.414422 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:40.414550 [debug] [MainThread]: On master: BEGIN
[0m18:20:40.414669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:20:40.416756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:20:40.416937 [debug] [MainThread]: On master: COMMIT
[0m18:20:40.417071 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:40.417199 [debug] [MainThread]: On master: COMMIT
[0m18:20:40.417494 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:20:40.417649 [debug] [MainThread]: On master: Close
[0m18:20:40.417963 [info ] [MainThread]: 
[0m18:20:40.418342 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:20:40.418569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:40.418688 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:20:40.418808 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:20:40.418920 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:20:40.422962 [info ] [MainThread]: 
[0m18:20:40.423232 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:20:40.423484 [info ] [MainThread]: 
[0m18:20:40.423702 [error] [MainThread]: [33mCompilation Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:20:40.423914 [error] [MainThread]:   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:20:40.424184 [info ] [MainThread]: 
[0m18:20:40.424654 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:24:58.930301 | 12f691f4-12f7-4d64-a74e-9da397a5c7e3 ==============================
[0m18:24:58.930311 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:24:58.930670 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:24:58.930844 [debug] [MainThread]: Tracking: do not track
[0m18:24:58.963971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:24:58.964526 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:24:58.979179 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:24:58.995852 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:24:59.011415 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:24:59.024579 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:24:59.026561 [info ] [MainThread]: 
[0m18:24:59.027147 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:24:59.028027 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:24:59.035458 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:24:59.035635 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:24:59.035779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:59.040394 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:24:59.041554 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:24:59.043000 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:24:59.047883 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:24:59.048076 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:24:59.048202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:59.050569 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:24:59.050767 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:24:59.050906 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:24:59.052874 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:24:59.054643 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:24:59.054936 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:24:59.059109 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:59.059323 [debug] [MainThread]: On master: BEGIN
[0m18:24:59.059450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:59.061652 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:24:59.061816 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:59.061942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:24:59.067529 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:24:59.068463 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:59.068732 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:59.068877 [debug] [MainThread]: On master: BEGIN
[0m18:24:59.069264 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:24:59.069469 [debug] [MainThread]: On master: COMMIT
[0m18:24:59.069633 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:59.069792 [debug] [MainThread]: On master: COMMIT
[0m18:24:59.070067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:24:59.070222 [debug] [MainThread]: On master: Close
[0m18:24:59.070578 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:24:59.070889 [info ] [MainThread]: 
[0m18:24:59.074279 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:24:59.074468 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:24:59.074818 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:24:59.075134 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:24:59.075606 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:24:59.076056 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:24:59.076249 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:24:59.076492 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:24:59.076658 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:24:59.076843 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:24:59.077954 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:24:59.080267 [debug] [Thread-2 (]: finished collecting timing info
[0m18:24:59.080530 [debug] [Thread-2 (]: Compilation Error in model dim_mes (models/dim_mes.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:24:59.080799 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.00s]
[0m18:24:59.081137 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:24:59.081501 [debug] [Thread-1 (]: finished collecting timing info
[0m18:24:59.081666 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:24:59.111837 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:24:59.112208 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:24:59.112346 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:24:59.112471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:59.114776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:59.114944 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:24:59.115071 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:24:59.117408 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:24:59.122140 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:24:59.122306 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:24:59.122824 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:59.124576 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:24:59.124715 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:24:59.125137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:59.139442 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:24:59.139630 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:24:59.139794 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:24:59.142401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:59.146961 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:24:59.147142 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:24:59.149642 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:24:59.150571 [debug] [Thread-1 (]: finished collecting timing info
[0m18:24:59.150733 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:24:59.151186 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.08s]
[0m18:24:59.151607 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:24:59.152205 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:24:59.152452 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:24:59.152850 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:24:59.152992 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:24:59.153126 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:24:59.160351 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:24:59.160521 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:24:59.160680 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:24:59.163247 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:59.163537 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:24:59.163939 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:24:59.171012 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:24:59.174712 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:24:59.175029 [debug] [Thread-4 (]: finished collecting timing info
[0m18:24:59.175249 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:24:59.191958 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:24:59.192304 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:24:59.192441 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:24:59.232385 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:24:59.234540 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:24:59.234690 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:24:59.235093 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:59.236767 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:24:59.236917 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:24:59.237264 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:59.241786 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:24:59.241937 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:24:59.242066 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:24:59.243918 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:59.245266 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:24:59.245406 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:24:59.246608 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:59.247620 [debug] [Thread-4 (]: finished collecting timing info
[0m18:24:59.247785 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:24:59.248177 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.10s]
[0m18:24:59.248533 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:24:59.249523 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:24:59.249697 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:59.249836 [debug] [MainThread]: On master: BEGIN
[0m18:24:59.249966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:24:59.252040 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:24:59.252208 [debug] [MainThread]: On master: COMMIT
[0m18:24:59.252346 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:59.252479 [debug] [MainThread]: On master: COMMIT
[0m18:24:59.252715 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:24:59.252876 [debug] [MainThread]: On master: Close
[0m18:24:59.253196 [info ] [MainThread]: 
[0m18:24:59.253458 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:24:59.253700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:59.253826 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:24:59.253951 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:24:59.254074 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:24:59.258180 [info ] [MainThread]: 
[0m18:24:59.258465 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:24:59.258727 [info ] [MainThread]: 
[0m18:24:59.258957 [error] [MainThread]: [33mCompilation Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:24:59.259182 [error] [MainThread]:   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:24:59.259424 [info ] [MainThread]: 
[0m18:24:59.259646 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:25:08.005139 | 89f261ee-f750-4272-ba3a-e8d3bb9d3459 ==============================
[0m18:25:08.005148 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:25:08.005456 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m18:25:08.005588 [debug] [MainThread]: Tracking: do not track
[0m18:25:08.006492 [info ] [MainThread]: Warning: No packages were found in packages.yml


============================== 2022-08-03 18:26:35.706535 | 1c08ad14-6484-481b-90de-d347e0451565 ==============================
[0m18:26:35.706545 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:26:35.707086 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:26:35.707235 [debug] [MainThread]: Tracking: do not track
[0m18:26:35.760595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:35.761048 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:26:35.770161 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:26:35.782173 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:26:35.791563 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:26:35.799389 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:26:35.800372 [info ] [MainThread]: 
[0m18:26:35.800760 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:26:35.801396 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:26:35.808935 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:26:35.809128 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:26:35.809336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:35.836497 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
[0m18:26:35.837546 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:26:35.838568 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:26:35.843393 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:26:35.843573 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:26:35.843717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:35.846265 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:26:35.846463 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:26:35.846620 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:26:35.850622 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:26:35.852278 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:26:35.852548 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:26:35.857668 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:35.857874 [debug] [MainThread]: On master: BEGIN
[0m18:26:35.858021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:35.860617 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:35.860804 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:35.860948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:26:35.867459 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:26:35.868655 [debug] [MainThread]: On master: ROLLBACK
[0m18:26:35.868960 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:35.869147 [debug] [MainThread]: On master: BEGIN
[0m18:26:35.869632 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:35.869825 [debug] [MainThread]: On master: COMMIT
[0m18:26:35.869989 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:35.870143 [debug] [MainThread]: On master: COMMIT
[0m18:26:35.870447 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:35.870644 [debug] [MainThread]: On master: Close
[0m18:26:35.870997 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:26:35.871314 [info ] [MainThread]: 
[0m18:26:35.877853 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:26:35.878099 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:26:35.878397 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:26:35.878755 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:26:35.879315 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:26:35.879839 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:26:35.880083 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:26:35.880289 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:26:35.880516 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:26:35.880765 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:26:35.882307 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:26:35.884833 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:26:35.886405 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:35.886681 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:26:35.892003 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:35.898850 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:26:35.953244 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:26:35.954870 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:26:35.956532 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:26:35.956809 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:26:35.957024 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:26:35.957290 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:26:35.957547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:35.957815 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:26:35.960853 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:35.961095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:35.961277 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:26:35.961532 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:26:35.961745 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT 
md5(mes_acporc) as mes_id,
MES_ACPORC
GROUP BY mes_acporc
FROM tb_acporc
  );
[0m18:26:35.961988 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:26:35.962988 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 12: FROM tb_acporc
         ^

[0m18:26:35.963200 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: ROLLBACK
[0m18:26:35.963986 [debug] [Thread-2 (]: finished collecting timing info
[0m18:26:35.964409 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:26:35.965120 [debug] [Thread-2 (]: Database Error in model dim_mes (models/dim_mes.sql)
  syntax error at or near "FROM"
  LINE 12: FROM tb_acporc
           ^
  compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:26:35.965834 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.09s]
[0m18:26:35.966798 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:26:35.967094 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:26:35.973753 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:26:35.973970 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:26:35.974645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:26:35.978239 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:26:35.978514 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:26:35.979129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:26:35.999201 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:26:35.999446 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:26:35.999594 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:26:36.002745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:26:36.012830 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:26:36.013189 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:26:36.016347 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:26:36.017775 [debug] [Thread-1 (]: finished collecting timing info
[0m18:26:36.018041 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:26:36.018801 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.14s]
[0m18:26:36.019411 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:26:36.020229 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:26:36.020593 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:26:36.021234 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:26:36.021435 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:26:36.021629 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:26:36.031560 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:26:36.031804 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:26:36.031989 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:26:36.034760 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:36.035015 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:26:36.035179 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:26:36.042756 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:26:36.047025 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:26:36.047405 [debug] [Thread-4 (]: finished collecting timing info
[0m18:26:36.047596 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:26:36.052480 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:26:36.052839 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:26:36.053007 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:26:36.230647 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.18 seconds
[0m18:26:36.233227 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:26:36.233414 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:26:36.233993 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:26:36.236037 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:26:36.236216 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:26:36.236573 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:26:36.241512 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:26:36.241658 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:26:36.241783 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:26:36.242458 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:26:36.243833 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:26:36.243971 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:26:36.246444 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:26:36.247338 [debug] [Thread-4 (]: finished collecting timing info
[0m18:26:36.247509 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:26:36.247897 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.23s]
[0m18:26:36.248279 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:26:36.249438 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:26:36.249636 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:36.249785 [debug] [MainThread]: On master: BEGIN
[0m18:26:36.249946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:26:36.252007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:36.252180 [debug] [MainThread]: On master: COMMIT
[0m18:26:36.252344 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:36.252514 [debug] [MainThread]: On master: COMMIT
[0m18:26:36.252794 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:36.252950 [debug] [MainThread]: On master: Close
[0m18:26:36.253295 [info ] [MainThread]: 
[0m18:26:36.253571 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m18:26:36.253857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:36.254007 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:26:36.254122 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:26:36.254234 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:26:36.258936 [info ] [MainThread]: 
[0m18:26:36.259197 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:26:36.259488 [info ] [MainThread]: 
[0m18:26:36.259705 [error] [MainThread]: [33mDatabase Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:26:36.259916 [error] [MainThread]:   syntax error at or near "FROM"
[0m18:26:36.260211 [error] [MainThread]:   LINE 12: FROM tb_acporc
[0m18:26:36.260498 [error] [MainThread]:            ^
[0m18:26:36.260709 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:26:36.260921 [info ] [MainThread]: 
[0m18:26:36.261127 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:26:59.988887 | 98fa613d-b3a3-470b-b04c-9d459090cb04 ==============================
[0m18:26:59.988897 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:26:59.989232 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:26:59.989380 [debug] [MainThread]: Tracking: do not track
[0m18:27:00.013683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:00.014196 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:27:00.023641 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:27:00.036756 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:27:00.046599 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:27:00.054436 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:27:00.055384 [info ] [MainThread]: 
[0m18:27:00.055778 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:27:00.056397 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:27:00.064087 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:27:00.064286 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:27:00.064427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:00.069598 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:27:00.070578 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:27:00.071574 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:27:00.076620 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:27:00.076856 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:27:00.077016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:00.080624 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:27:00.080851 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:27:00.080988 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:27:00.082918 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:27:00.084335 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:27:00.084593 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:27:00.088744 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:00.088913 [debug] [MainThread]: On master: BEGIN
[0m18:27:00.089042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:00.091341 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:00.091546 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:00.091764 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:27:00.097978 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:27:00.099086 [debug] [MainThread]: On master: ROLLBACK
[0m18:27:00.099467 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:00.099646 [debug] [MainThread]: On master: BEGIN
[0m18:27:00.100058 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:00.100223 [debug] [MainThread]: On master: COMMIT
[0m18:27:00.100374 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:00.100499 [debug] [MainThread]: On master: COMMIT
[0m18:27:00.100762 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:00.100920 [debug] [MainThread]: On master: Close
[0m18:27:00.101218 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:27:00.101474 [info ] [MainThread]: 
[0m18:27:00.104543 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:27:00.104740 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:27:00.105001 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:27:00.105359 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:27:00.105844 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:27:00.106289 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:27:00.106487 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:27:00.106672 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:27:00.106836 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:27:00.106979 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:27:00.108180 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:27:00.111876 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:27:00.112828 [debug] [Thread-1 (]: finished collecting timing info
[0m18:27:00.113104 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:27:00.113239 [debug] [Thread-2 (]: finished collecting timing info
[0m18:27:00.128919 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:27:00.160111 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:27:00.162262 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:27:00.162668 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:00.162815 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:27:00.162943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:00.163218 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:27:00.163394 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:27:00.163651 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:27:00.165356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:00.165689 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:00.165845 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:27:00.166147 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:00.166502 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:27:00.166639 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT 
md5(mes_acporc) as mes_id,
MES_ACPORC
FROM tb_acporc
  );
[0m18:27:00.167076 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function md5(double precision) does not exist
LINE 9: md5(mes_acporc) as mes_id,
        ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:27:00.167240 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: ROLLBACK
[0m18:27:00.167611 [debug] [Thread-2 (]: finished collecting timing info
[0m18:27:00.167773 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:27:00.168091 [debug] [Thread-2 (]: Database Error in model dim_mes (models/dim_mes.sql)
  function md5(double precision) does not exist
  LINE 9: md5(mes_acporc) as mes_id,
          ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:27:00.168244 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:00.168592 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.06s]
[0m18:27:00.173394 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:00.173837 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:27:00.174027 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:27:00.174643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:00.176789 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:00.177035 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:27:00.177510 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:00.193193 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:27:00.193465 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:00.193722 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:27:00.196334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:27:00.200882 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:00.201098 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:27:00.203634 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:00.206697 [debug] [Thread-1 (]: finished collecting timing info
[0m18:27:00.207269 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:27:00.208506 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:27:00.209552 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:27:00.210955 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:27:00.211868 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:27:00.212894 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:00.213253 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:27:00.213526 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:27:00.225759 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:00.226073 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:27:00.226270 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:27:00.229112 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:00.229350 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:00.229519 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:27:00.237196 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:27:00.241268 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:27:00.241716 [debug] [Thread-4 (]: finished collecting timing info
[0m18:27:00.241900 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:27:00.246090 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:27:00.246379 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:00.246532 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:27:00.286967 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:27:00.289129 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:00.289290 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:27:00.289690 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:00.291452 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:00.291634 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:27:00.292058 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:00.296876 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:27:00.297044 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:00.297173 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:27:00.299381 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:27:00.300852 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:00.300995 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:27:00.303243 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:27:00.304084 [debug] [Thread-4 (]: finished collecting timing info
[0m18:27:00.304246 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:27:00.304627 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.09s]
[0m18:27:00.304981 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:27:00.306048 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:27:00.306218 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:00.306352 [debug] [MainThread]: On master: BEGIN
[0m18:27:00.306476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:00.308767 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:00.308996 [debug] [MainThread]: On master: COMMIT
[0m18:27:00.309135 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:00.309285 [debug] [MainThread]: On master: COMMIT
[0m18:27:00.309486 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:00.309630 [debug] [MainThread]: On master: Close
[0m18:27:00.309974 [info ] [MainThread]: 
[0m18:27:00.310239 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m18:27:00.310472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:00.310595 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:27:00.310711 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:27:00.310826 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:27:00.314851 [info ] [MainThread]: 
[0m18:27:00.315126 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:27:00.315380 [info ] [MainThread]: 
[0m18:27:00.315599 [error] [MainThread]: [33mDatabase Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:27:00.315816 [error] [MainThread]:   function md5(double precision) does not exist
[0m18:27:00.316034 [error] [MainThread]:   LINE 9: md5(mes_acporc) as mes_id,
[0m18:27:00.316236 [error] [MainThread]:           ^
[0m18:27:00.316436 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m18:27:00.316646 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:27:00.316860 [info ] [MainThread]: 
[0m18:27:00.317070 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:27:57.357634 | 9d15af6b-ab30-421d-80d5-f3a5ee9c26f5 ==============================
[0m18:27:57.357644 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:27:57.357968 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:27:57.358113 [debug] [MainThread]: Tracking: do not track
[0m18:27:57.380663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:57.381009 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:27:57.391039 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:27:57.401835 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:27:57.411269 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:27:57.420677 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:27:57.421727 [info ] [MainThread]: 
[0m18:27:57.422371 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:27:57.423157 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:27:57.430688 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:27:57.430869 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:27:57.431012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:57.436333 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:27:57.437265 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:27:57.438208 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:27:57.442713 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:27:57.442876 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:27:57.443037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:57.445434 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:27:57.445613 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:27:57.445772 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:27:57.447766 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:27:57.449316 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:27:57.449597 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:27:57.454943 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:57.455141 [debug] [MainThread]: On master: BEGIN
[0m18:27:57.455281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:57.457649 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:57.457921 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:57.458089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:27:57.463951 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:27:57.465004 [debug] [MainThread]: On master: ROLLBACK
[0m18:27:57.465298 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:57.465446 [debug] [MainThread]: On master: BEGIN
[0m18:27:57.465819 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:57.466034 [debug] [MainThread]: On master: COMMIT
[0m18:27:57.466163 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:57.466282 [debug] [MainThread]: On master: COMMIT
[0m18:27:57.466536 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:57.466671 [debug] [MainThread]: On master: Close
[0m18:27:57.466999 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:27:57.467266 [info ] [MainThread]: 
[0m18:27:57.470439 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:27:57.470658 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:27:57.470895 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:27:57.471186 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:27:57.471613 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:27:57.472083 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:27:57.472303 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:27:57.472467 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:27:57.472716 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:27:57.472863 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:27:57.474079 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:27:57.475700 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:27:57.476150 [debug] [Thread-1 (]: finished collecting timing info
[0m18:27:57.476306 [debug] [Thread-2 (]: finished collecting timing info
[0m18:27:57.476460 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:27:57.476662 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:27:57.530353 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:27:57.531179 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:27:57.531604 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:27:57.531745 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:27:57.531875 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:27:57.532162 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:57.532309 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:27:57.532430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:57.534391 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:57.534577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:57.534720 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:27:57.534866 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:57.535011 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT 
md5(string(mes_acporc)) as mes_id,
MES_ACPORC
GROUP BY mes_acporc
FROM tb_acporc
  );
[0m18:27:57.535152 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:27:57.535472 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 12: FROM tb_acporc
         ^

[0m18:27:57.535631 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: ROLLBACK
[0m18:27:57.535971 [debug] [Thread-2 (]: finished collecting timing info
[0m18:27:57.536117 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:27:57.536479 [debug] [Thread-2 (]: Database Error in model dim_mes (models/dim_mes.sql)
  syntax error at or near "FROM"
  LINE 12: FROM tb_acporc
           ^
  compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:27:57.536815 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.06s]
[0m18:27:57.537246 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:27:57.537630 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:57.542262 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:57.542421 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:27:57.542914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:57.545389 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:57.545542 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:27:57.545961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:57.560849 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:27:57.561176 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:57.561349 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:27:57.564204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:27:57.568929 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:27:57.569147 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:27:57.570445 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:57.571387 [debug] [Thread-1 (]: finished collecting timing info
[0m18:27:57.571560 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:27:57.572141 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:27:57.572615 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:27:57.573312 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:27:57.573547 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:27:57.573953 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:57.574121 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:27:57.574276 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:27:57.582355 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:57.582540 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:27:57.582746 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:27:57.585047 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:57.585336 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:57.585465 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:27:57.591561 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:27:57.595110 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:27:57.595448 [debug] [Thread-4 (]: finished collecting timing info
[0m18:27:57.595652 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:27:57.600352 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:27:57.600970 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:57.601177 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:27:57.640405 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:27:57.642583 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:57.642740 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:27:57.643171 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:57.644847 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:57.644989 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:27:57.645336 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:57.650024 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:27:57.650183 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:57.650311 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:27:57.652447 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:27:57.655656 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:27:57.655806 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:27:57.657384 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:27:57.658221 [debug] [Thread-4 (]: finished collecting timing info
[0m18:27:57.658386 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:27:57.658770 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.08s]
[0m18:27:57.659153 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:27:57.660206 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:27:57.660379 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:57.660510 [debug] [MainThread]: On master: BEGIN
[0m18:27:57.660634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:57.662865 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:57.663029 [debug] [MainThread]: On master: COMMIT
[0m18:27:57.663167 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:57.663291 [debug] [MainThread]: On master: COMMIT
[0m18:27:57.663502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:57.663662 [debug] [MainThread]: On master: Close
[0m18:27:57.663980 [info ] [MainThread]: 
[0m18:27:57.664237 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m18:27:57.664473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:57.664594 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:27:57.664711 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:27:57.664824 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:27:57.668939 [info ] [MainThread]: 
[0m18:27:57.669227 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:27:57.669487 [info ] [MainThread]: 
[0m18:27:57.669711 [error] [MainThread]: [33mDatabase Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:27:57.669932 [error] [MainThread]:   syntax error at or near "FROM"
[0m18:27:57.670144 [error] [MainThread]:   LINE 12: FROM tb_acporc
[0m18:27:57.670357 [error] [MainThread]:            ^
[0m18:27:57.670634 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:27:57.670858 [info ] [MainThread]: 
[0m18:27:57.671070 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:28:11.135870 | 53ff96a8-0eea-46f7-aed3-12fbb16b9190 ==============================
[0m18:28:11.135885 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:28:11.136276 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:28:11.136446 [debug] [MainThread]: Tracking: do not track
[0m18:28:11.159950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:11.160334 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:28:11.169657 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:28:11.180338 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:28:11.189912 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:28:11.199364 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:28:11.200857 [info ] [MainThread]: 
[0m18:28:11.201383 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:28:11.202062 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:28:11.209657 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:28:11.209827 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:28:11.209953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:11.213652 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:28:11.214575 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:28:11.215458 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:28:11.219884 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:28:11.220037 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:28:11.220170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:11.222416 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:28:11.222625 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:28:11.222754 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:28:11.224631 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:28:11.226483 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:28:11.226836 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:28:11.231725 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:11.231928 [debug] [MainThread]: On master: BEGIN
[0m18:28:11.232056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:11.234608 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:11.234774 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:11.234899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:28:11.240522 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:28:11.241455 [debug] [MainThread]: On master: ROLLBACK
[0m18:28:11.241720 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:11.241862 [debug] [MainThread]: On master: BEGIN
[0m18:28:11.242292 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:11.242451 [debug] [MainThread]: On master: COMMIT
[0m18:28:11.242620 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:11.242740 [debug] [MainThread]: On master: COMMIT
[0m18:28:11.243010 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:28:11.243167 [debug] [MainThread]: On master: Close
[0m18:28:11.243497 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:28:11.243778 [info ] [MainThread]: 
[0m18:28:11.247165 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:28:11.247363 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:28:11.247597 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:28:11.247877 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:28:11.248311 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:28:11.248684 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:28:11.248870 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:28:11.249053 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:28:11.249245 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:28:11.249408 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:28:11.250465 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:28:11.252148 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:28:11.252491 [debug] [Thread-1 (]: finished collecting timing info
[0m18:28:11.252683 [debug] [Thread-2 (]: finished collecting timing info
[0m18:28:11.252841 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:28:11.252994 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:28:11.301623 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:28:11.304579 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:28:11.305004 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:11.305198 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:28:11.305362 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:28:11.305513 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:28:11.305695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:11.305854 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:28:11.308324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:11.308482 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:11.308648 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:11.308805 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:28:11.308984 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:28:11.309160 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT 
md5(mes_acporc) as mes_id,
MES_ACPORC
FROM tb_acporc
GROUP BY mes_acporc
  );
[0m18:28:11.309740 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function md5(double precision) does not exist
LINE 9: md5(mes_acporc) as mes_id,
        ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:28:11.309886 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: ROLLBACK
[0m18:28:11.310236 [debug] [Thread-2 (]: finished collecting timing info
[0m18:28:11.310381 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:28:11.310705 [debug] [Thread-2 (]: Database Error in model dim_mes (models/dim_mes.sql)
  function md5(double precision) does not exist
  LINE 9: md5(mes_acporc) as mes_id,
          ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:28:11.311032 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.06s]
[0m18:28:11.311516 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:28:11.311642 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:28:11.316278 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:11.316432 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:28:11.316879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:28:11.319485 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:11.319628 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:28:11.320029 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:28:11.334493 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:28:11.334682 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:11.334810 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:28:11.335786 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:28:11.339729 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:11.339929 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:28:11.342584 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:28:11.344290 [debug] [Thread-1 (]: finished collecting timing info
[0m18:28:11.344462 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:28:11.344923 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:28:11.345306 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:28:11.345787 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:28:11.346195 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:28:11.346581 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:11.346721 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:28:11.346851 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:28:11.353952 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:11.354114 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:28:11.354239 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:28:11.356532 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:11.356717 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:11.356848 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:28:11.362840 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:28:11.366338 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:28:11.366635 [debug] [Thread-4 (]: finished collecting timing info
[0m18:28:11.366787 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:28:11.370761 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:28:11.371192 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:11.371335 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:28:11.411722 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:28:11.413814 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:11.413961 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:28:11.414369 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:28:11.416041 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:11.416179 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:28:11.416542 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:28:11.421042 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:28:11.421189 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:11.421311 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:28:11.423388 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:28:11.425075 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:11.425249 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:28:11.426492 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:28:11.427293 [debug] [Thread-4 (]: finished collecting timing info
[0m18:28:11.427448 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:28:11.427856 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.08s]
[0m18:28:11.428235 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:28:11.429377 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:28:11.429546 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:11.429673 [debug] [MainThread]: On master: BEGIN
[0m18:28:11.429793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:28:11.431904 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:11.432066 [debug] [MainThread]: On master: COMMIT
[0m18:28:11.432194 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:11.432315 [debug] [MainThread]: On master: COMMIT
[0m18:28:11.432521 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:28:11.432707 [debug] [MainThread]: On master: Close
[0m18:28:11.433034 [info ] [MainThread]: 
[0m18:28:11.433296 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:28:11.433532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:11.433684 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:28:11.433797 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:28:11.433907 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:28:11.437912 [info ] [MainThread]: 
[0m18:28:11.438158 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:28:11.438402 [info ] [MainThread]: 
[0m18:28:11.438615 [error] [MainThread]: [33mDatabase Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:28:11.438822 [error] [MainThread]:   function md5(double precision) does not exist
[0m18:28:11.439055 [error] [MainThread]:   LINE 9: md5(mes_acporc) as mes_id,
[0m18:28:11.439292 [error] [MainThread]:           ^
[0m18:28:11.439523 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m18:28:11.439797 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:28:11.440048 [info ] [MainThread]: 
[0m18:28:11.440326 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:28:58.792511 | 82b46507-fb93-41ca-b29d-868e3aec36c9 ==============================
[0m18:28:58.792521 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:28:58.792885 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:28:58.793059 [debug] [MainThread]: Tracking: do not track
[0m18:28:58.816088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:58.816432 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:28:58.825675 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:28:58.836617 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:28:58.846312 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:28:58.855101 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:28:58.856366 [info ] [MainThread]: 
[0m18:28:58.857568 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:28:58.858603 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:28:58.865885 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:28:58.866083 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:28:58.866208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:58.869750 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:28:58.870710 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:28:58.871717 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:28:58.876164 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:28:58.876319 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:28:58.876442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:58.878815 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:28:58.879138 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:28:58.879314 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:28:58.881202 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:28:58.882681 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:28:58.883047 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:28:58.887733 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:58.888007 [debug] [MainThread]: On master: BEGIN
[0m18:28:58.888203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:58.891176 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:58.891352 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:58.891494 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:28:58.897181 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:28:58.898117 [debug] [MainThread]: On master: ROLLBACK
[0m18:28:58.898388 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:58.898530 [debug] [MainThread]: On master: BEGIN
[0m18:28:58.898921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:58.899068 [debug] [MainThread]: On master: COMMIT
[0m18:28:58.899194 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:58.899367 [debug] [MainThread]: On master: COMMIT
[0m18:28:58.899606 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:28:58.899761 [debug] [MainThread]: On master: Close
[0m18:28:58.900089 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:28:58.900370 [info ] [MainThread]: 
[0m18:28:58.903633 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:28:58.903816 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:28:58.904038 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:28:58.904312 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:28:58.904695 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:28:58.905036 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:28:58.905261 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:28:58.905450 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:28:58.905611 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:28:58.906746 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:28:58.906940 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:28:58.908719 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:28:58.908996 [debug] [Thread-2 (]: finished collecting timing info
[0m18:28:58.909119 [debug] [Thread-1 (]: finished collecting timing info
[0m18:28:58.909375 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:28:58.909556 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:28:58.960189 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:28:58.961715 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:28:58.962158 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:58.962329 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:28:58.962461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:58.962764 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:28:58.962910 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:28:58.963091 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:28:58.964930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:58.965213 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:58.965411 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:28:58.965590 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:58.965748 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:28:58.965898 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT 
md5(TO_STRING(mes_acporc)) as mes_id,
MES_ACPORC
FROM tb_acporc
GROUP BY mes_acporc
  );
[0m18:28:58.966372 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function to_string(double precision) does not exist
LINE 9: md5(TO_STRING(mes_acporc)) as mes_id,
            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:28:58.966523 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: ROLLBACK
[0m18:28:58.966809 [debug] [Thread-2 (]: finished collecting timing info
[0m18:28:58.966955 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:28:58.967347 [debug] [Thread-2 (]: Database Error in model dim_mes (models/dim_mes.sql)
  function to_string(double precision) does not exist
  LINE 9: md5(TO_STRING(mes_acporc)) as mes_id,
              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:28:58.967681 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:28:58.968018 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.06s]
[0m18:28:58.972839 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:58.973391 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:28:58.973581 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:28:58.974208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:28:58.976779 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:58.976923 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:28:58.977392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:28:58.991759 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:28:58.991954 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:58.992093 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:28:58.994427 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:28:58.998010 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:28:58.998154 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:28:58.999339 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:28:59.000213 [debug] [Thread-1 (]: finished collecting timing info
[0m18:28:59.000379 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:28:59.000804 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:28:59.001321 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:28:59.002012 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:28:59.002299 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:28:59.002779 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:59.002927 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:28:59.003090 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:28:59.011580 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:59.011787 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:28:59.011914 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:28:59.014261 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:59.014537 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:59.014665 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:28:59.020842 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:28:59.024478 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:28:59.024769 [debug] [Thread-4 (]: finished collecting timing info
[0m18:28:59.024944 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:28:59.028748 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:28:59.029002 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:59.029149 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:28:59.070076 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:28:59.072128 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:59.072276 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:28:59.072662 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:28:59.074320 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:59.074459 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:28:59.074783 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:28:59.079541 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:28:59.079697 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:59.079837 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:28:59.081669 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:28:59.083082 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:28:59.083218 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:28:59.085516 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:28:59.086350 [debug] [Thread-4 (]: finished collecting timing info
[0m18:28:59.086506 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:28:59.087001 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.08s]
[0m18:28:59.087352 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:28:59.088700 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:28:59.088865 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:59.088993 [debug] [MainThread]: On master: BEGIN
[0m18:28:59.089110 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:28:59.091396 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:59.091567 [debug] [MainThread]: On master: COMMIT
[0m18:28:59.091695 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:59.091814 [debug] [MainThread]: On master: COMMIT
[0m18:28:59.091996 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:28:59.092156 [debug] [MainThread]: On master: Close
[0m18:28:59.092599 [info ] [MainThread]: 
[0m18:28:59.093231 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m18:28:59.093705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:59.093824 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:28:59.094066 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:28:59.094232 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:28:59.098315 [info ] [MainThread]: 
[0m18:28:59.098579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:28:59.098949 [info ] [MainThread]: 
[0m18:28:59.099247 [error] [MainThread]: [33mDatabase Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:28:59.099552 [error] [MainThread]:   function to_string(double precision) does not exist
[0m18:28:59.099837 [error] [MainThread]:   LINE 9: md5(TO_STRING(mes_acporc)) as mes_id,
[0m18:28:59.100056 [error] [MainThread]:               ^
[0m18:28:59.100273 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m18:28:59.100470 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:28:59.100678 [info ] [MainThread]: 
[0m18:28:59.100888 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:29:17.452727 | ef24ed71-5eee-4751-a712-260e86610b87 ==============================
[0m18:29:17.452736 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:29:17.453056 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:29:17.453191 [debug] [MainThread]: Tracking: do not track
[0m18:29:17.475552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:29:17.475931 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:29:17.484881 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:29:17.495592 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:29:17.505137 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:29:17.513462 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:29:17.514460 [info ] [MainThread]: 
[0m18:29:17.515058 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:29:17.516743 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:29:17.524326 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:29:17.524488 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:29:17.524615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:17.528367 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:29:17.529358 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:29:17.530401 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:29:17.534725 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:29:17.534965 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:29:17.535104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:29:17.537513 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:29:17.537680 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:29:17.537805 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:29:17.539809 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:29:17.541204 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:29:17.541520 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:29:17.546216 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:17.546429 [debug] [MainThread]: On master: BEGIN
[0m18:29:17.546571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:17.549060 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:29:17.549434 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:17.549633 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:29:17.555361 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:29:17.556352 [debug] [MainThread]: On master: ROLLBACK
[0m18:29:17.556623 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:17.556766 [debug] [MainThread]: On master: BEGIN
[0m18:29:17.557168 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:29:17.557317 [debug] [MainThread]: On master: COMMIT
[0m18:29:17.557442 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:17.557561 [debug] [MainThread]: On master: COMMIT
[0m18:29:17.557815 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:29:17.557970 [debug] [MainThread]: On master: Close
[0m18:29:17.558319 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:29:17.558603 [info ] [MainThread]: 
[0m18:29:17.561839 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:29:17.562027 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:29:17.562274 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:29:17.562503 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:29:17.562998 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:29:17.563422 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:29:17.563574 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:29:17.563740 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:29:17.563894 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:29:17.564029 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:29:17.565092 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:29:17.566717 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:29:17.567064 [debug] [Thread-1 (]: finished collecting timing info
[0m18:29:17.567262 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:29:17.567405 [debug] [Thread-2 (]: finished collecting timing info
[0m18:29:17.593311 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:29:17.597159 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:29:17.613336 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:29:17.613671 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:29:17.613815 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:29:17.614005 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:29:17.614153 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:29:17.614328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:17.614519 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:29:17.617051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:29:17.617224 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:29:17.617511 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:29:17.617703 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:29:17.617851 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:29:17.618044 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT 
md5(AS_TEXT(mes_acporc)) as mes_id,
MES_ACPORC
FROM tb_acporc
GROUP BY mes_acporc
  );
[0m18:29:17.618577 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function as_text(double precision) does not exist
LINE 9: md5(AS_TEXT(mes_acporc)) as mes_id,
            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:29:17.618881 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: ROLLBACK
[0m18:29:17.619366 [debug] [Thread-2 (]: finished collecting timing info
[0m18:29:17.619519 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:29:17.619853 [debug] [Thread-2 (]: Database Error in model dim_mes (models/dim_mes.sql)
  function as_text(double precision) does not exist
  LINE 9: md5(AS_TEXT(mes_acporc)) as mes_id,
              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:29:17.620202 [error] [Thread-2 (]: 2 of 3 ERROR creating table model public.dim_mes ....................................................................... [[31mERROR[0m in 0.06s]
[0m18:29:17.620396 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:17.620831 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:29:17.625457 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:29:17.625811 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:29:17.626337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:17.628843 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:29:17.628984 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:29:17.629438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:17.644033 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:29:17.644224 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:29:17.644353 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:29:17.646577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:29:17.650474 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:29:17.650681 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:29:17.652438 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:17.653796 [debug] [Thread-1 (]: finished collecting timing info
[0m18:29:17.653967 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:29:17.654368 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.09s]
[0m18:29:17.654723 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:29:17.655336 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:29:17.655560 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:29:17.655991 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:29:17.656139 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:29:17.656287 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:29:17.663438 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:29:17.663604 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:29:17.663742 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:29:17.665996 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:29:17.666169 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:29:17.666304 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:29:17.672350 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:29:17.675804 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:29:17.676158 [debug] [Thread-4 (]: finished collecting timing info
[0m18:29:17.676311 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:29:17.680191 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:29:17.680554 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:29:17.680694 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:29:17.721529 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:29:17.723643 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:29:17.723817 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:29:17.724203 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:17.725831 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:29:17.726018 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:29:17.726354 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:17.730843 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:29:17.730999 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:29:17.731135 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:29:17.733004 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:29:17.734427 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:29:17.734572 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:29:17.736877 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:29:17.737686 [debug] [Thread-4 (]: finished collecting timing info
[0m18:29:17.737850 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:29:17.738234 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.08s]
[0m18:29:17.738588 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:29:17.739756 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:29:17.739932 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:17.740064 [debug] [MainThread]: On master: BEGIN
[0m18:29:17.740200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:29:17.742428 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:29:17.742641 [debug] [MainThread]: On master: COMMIT
[0m18:29:17.742777 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:17.742912 [debug] [MainThread]: On master: COMMIT
[0m18:29:17.743133 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:29:17.743276 [debug] [MainThread]: On master: Close
[0m18:29:17.743628 [info ] [MainThread]: 
[0m18:29:17.743883 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:29:17.744149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:17.744271 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:29:17.744394 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:29:17.744521 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:29:17.748659 [info ] [MainThread]: 
[0m18:29:17.748967 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:29:17.749310 [info ] [MainThread]: 
[0m18:29:17.749528 [error] [MainThread]: [33mDatabase Error in model dim_mes (models/dim_mes.sql)[0m
[0m18:29:17.749738 [error] [MainThread]:   function as_text(double precision) does not exist
[0m18:29:17.750046 [error] [MainThread]:   LINE 9: md5(AS_TEXT(mes_acporc)) as mes_id,
[0m18:29:17.750377 [error] [MainThread]:               ^
[0m18:29:17.750703 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m18:29:17.751023 [error] [MainThread]:   compiled SQL at target/run/postgres_test/models/dim_mes.sql
[0m18:29:17.751439 [info ] [MainThread]: 
[0m18:29:17.751661 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3


============================== 2022-08-03 18:30:24.764057 | b531847e-f925-4c81-926f-e6afffc1a79d ==============================
[0m18:30:24.764067 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:30:24.764422 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 120, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/rodrigo/.dbt', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:30:24.764585 [debug] [MainThread]: Tracking: do not track
[0m18:30:24.787534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:30:24.787914 [debug] [MainThread]: Partial parsing: updated file: postgres_test://models/dim_mes.sql
[0m18:30:24.797390 [debug] [MainThread]: 1603: static parser failed on dim_mes.sql
[0m18:30:24.807925 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dim_mes.sql
[0m18:30:24.817567 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_test.example

[0m18:30:24.826983 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:30:24.828412 [info ] [MainThread]: 
[0m18:30:24.828994 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:30:24.829805 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte"
[0m18:30:24.836921 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m18:30:24.837081 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m18:30:24.837251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:24.842740 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:30:24.843702 [debug] [ThreadPool]: On list_airbyte: Close
[0m18:30:24.844684 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbyte_public"
[0m18:30:24.849023 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:30:24.849192 [debug] [ThreadPool]: On list_airbyte_public: BEGIN
[0m18:30:24.849372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:24.851473 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:30:24.851693 [debug] [ThreadPool]: Using postgres connection "list_airbyte_public"
[0m18:30:24.851849 [debug] [ThreadPool]: On list_airbyte_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_airbyte_public"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:30:24.854043 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m18:30:24.855576 [debug] [ThreadPool]: On list_airbyte_public: ROLLBACK
[0m18:30:24.855985 [debug] [ThreadPool]: On list_airbyte_public: Close
[0m18:30:24.861807 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:24.862000 [debug] [MainThread]: On master: BEGIN
[0m18:30:24.862127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:30:24.864573 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:30:24.864847 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:24.864982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:30:24.870645 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:30:24.871578 [debug] [MainThread]: On master: ROLLBACK
[0m18:30:24.871912 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:24.872117 [debug] [MainThread]: On master: BEGIN
[0m18:30:24.872468 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:30:24.872681 [debug] [MainThread]: On master: COMMIT
[0m18:30:24.872809 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:24.872940 [debug] [MainThread]: On master: COMMIT
[0m18:30:24.873202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:30:24.873358 [debug] [MainThread]: On master: Close
[0m18:30:24.873650 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:30:24.873931 [info ] [MainThread]: 
[0m18:30:24.877097 [debug] [Thread-1 (]: Began running node model.postgres_test.acporc
[0m18:30:24.877289 [debug] [Thread-2 (]: Began running node model.postgres_test.dim_mes
[0m18:30:24.877571 [info ] [Thread-1 (]: 1 of 3 START view model public.acporc .................................................................................. [RUN]
[0m18:30:24.877864 [info ] [Thread-2 (]: 2 of 3 START table model public.dim_mes ................................................................................ [RUN]
[0m18:30:24.878296 [debug] [Thread-1 (]: Acquiring new postgres connection "model.postgres_test.acporc"
[0m18:30:24.878714 [debug] [Thread-2 (]: Acquiring new postgres connection "model.postgres_test.dim_mes"
[0m18:30:24.878866 [debug] [Thread-1 (]: Began compiling node model.postgres_test.acporc
[0m18:30:24.879043 [debug] [Thread-2 (]: Began compiling node model.postgres_test.dim_mes
[0m18:30:24.879241 [debug] [Thread-1 (]: Compiling model.postgres_test.acporc
[0m18:30:24.879382 [debug] [Thread-2 (]: Compiling model.postgres_test.dim_mes
[0m18:30:24.880512 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_test.acporc"
[0m18:30:24.882141 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_test.dim_mes"
[0m18:30:24.882565 [debug] [Thread-1 (]: finished collecting timing info
[0m18:30:24.882758 [debug] [Thread-1 (]: Began executing node model.postgres_test.acporc
[0m18:30:24.903515 [debug] [Thread-2 (]: finished collecting timing info
[0m18:30:24.912195 [debug] [Thread-1 (]: Writing runtime SQL for node "model.postgres_test.acporc"
[0m18:30:24.912407 [debug] [Thread-2 (]: Began executing node model.postgres_test.dim_mes
[0m18:30:24.928533 [debug] [Thread-2 (]: Writing runtime SQL for node "model.postgres_test.dim_mes"
[0m18:30:24.928744 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:30:24.928984 [debug] [Thread-1 (]: On model.postgres_test.acporc: BEGIN
[0m18:30:24.929155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:24.929456 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:30:24.929629 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: BEGIN
[0m18:30:24.929791 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:30:24.931723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:30:24.932012 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:30:24.932249 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:30:24.932462 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */

  create view "airbyte"."public"."acporc__dbt_tmp" as (
    -- Cria Modelo com todas as colunas da TB_ACPORC
-- mas sem salvá-lo como uma tabela no DB
SELECT *
FROM tb_acporc
  );
[0m18:30:24.932680 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:30:24.932950 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */


  create  table "airbyte"."public"."dim_mes__dbt_tmp"
  as (
    

SELECT 
md5(CAST(mes_acporc AS TEXT)) as mes_id,
MES_ACPORC
FROM tb_acporc
GROUP BY mes_acporc
  );
[0m18:30:24.934732 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:30:24.939843 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:30:24.940160 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc" rename to "acporc__dbt_backup"
[0m18:30:24.940878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:30:24.946216 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:30:24.946565 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
alter table "airbyte"."public"."acporc__dbt_tmp" rename to "acporc"
[0m18:30:24.947312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:30:24.969284 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:30:24.970407 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:30:24.972327 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:30:24.972543 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:30:24.972778 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
alter table "airbyte"."public"."dim_mes" rename to "dim_mes__dbt_backup"
[0m18:30:24.973000 [debug] [Thread-1 (]: On model.postgres_test.acporc: COMMIT
[0m18:30:24.973554 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:30:24.975232 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:30:24.975373 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
alter table "airbyte"."public"."dim_mes__dbt_tmp" rename to "dim_mes"
[0m18:30:24.975530 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:30:24.975738 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:30:24.979239 [debug] [Thread-1 (]: Using postgres connection "model.postgres_test.acporc"
[0m18:30:24.983692 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:30:24.983884 [debug] [Thread-1 (]: On model.postgres_test.acporc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.acporc"} */
drop view if exists "airbyte"."public"."acporc__dbt_backup" cascade
[0m18:30:24.984106 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:30:24.984411 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: COMMIT
[0m18:30:24.986262 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:30:24.991583 [debug] [Thread-2 (]: Using postgres connection "model.postgres_test.dim_mes"
[0m18:30:24.992181 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.dim_mes"} */
drop table if exists "airbyte"."public"."dim_mes__dbt_backup" cascade
[0m18:30:24.992731 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m18:30:24.996314 [debug] [Thread-1 (]: finished collecting timing info
[0m18:30:24.996945 [debug] [Thread-1 (]: On model.postgres_test.acporc: Close
[0m18:30:24.997548 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:30:24.999298 [info ] [Thread-1 (]: 1 of 3 OK created view model public.acporc ............................................................................. [[32mCREATE VIEW[0m in 0.12s]
[0m18:30:25.002303 [debug] [Thread-2 (]: finished collecting timing info
[0m18:30:25.003932 [debug] [Thread-1 (]: Finished running node model.postgres_test.acporc
[0m18:30:25.004656 [debug] [Thread-2 (]: On model.postgres_test.dim_mes: Close
[0m18:30:25.006554 [debug] [Thread-4 (]: Began running node model.postgres_test.soma_vals_por_mes
[0m18:30:25.007610 [info ] [Thread-4 (]: 3 of 3 START table model public.soma_vals_por_mes ...................................................................... [RUN]
[0m18:30:25.009363 [info ] [Thread-2 (]: 2 of 3 OK created table model public.dim_mes ........................................................................... [[32mSELECT 13[0m in 0.13s]
[0m18:30:25.011489 [debug] [Thread-4 (]: Acquiring new postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:30:25.012936 [debug] [Thread-2 (]: Finished running node model.postgres_test.dim_mes
[0m18:30:25.013626 [debug] [Thread-4 (]: Began compiling node model.postgres_test.soma_vals_por_mes
[0m18:30:25.014931 [debug] [Thread-4 (]: Compiling model.postgres_test.soma_vals_por_mes
[0m18:30:25.042897 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:30:25.043416 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: BEGIN
[0m18:30:25.043729 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:30:25.047790 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:30:25.048078 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:30:25.048315 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'acporc'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:30:25.057888 [debug] [Thread-4 (]: SQL status: SELECT 31 in 0.01 seconds
[0m18:30:25.062892 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:30:25.063319 [debug] [Thread-4 (]: finished collecting timing info
[0m18:30:25.063552 [debug] [Thread-4 (]: Began executing node model.postgres_test.soma_vals_por_mes
[0m18:30:25.069456 [debug] [Thread-4 (]: Writing runtime SQL for node "model.postgres_test.soma_vals_por_mes"
[0m18:30:25.069908 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:30:25.070125 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */


  create  table "airbyte"."public"."soma_vals_por_mes__dbt_tmp"
  as (
    


with vals as (
    select 
    MES_ACPORC as Mes
    
        , SUM(val_melhor_est) as SOMA_val_melhor_est
    
        , SUM(val_econ_parcial) as SOMA_val_econ_parcial
    
        , SUM(valprev_atu_acporc) as SOMA_valprev_atu_acporc
    
        , SUM(valprev_ini_acporc) as SOMA_valprev_ini_acporc
    
        , SUM(valreal_man_acporc) as SOMA_valreal_man_acporc
    
        , SUM(valreal_mis_acporc) as SOMA_valreal_mis_acporc
    
        , SUM(valprev_ver1_acporc) as SOMA_valprev_ver1_acporc
    
        , SUM(valprev_ver2_acporc) as SOMA_valprev_ver2_acporc
    
        , SUM(valprev_ver3_acporc) as SOMA_valprev_ver3_acporc
    
        , SUM(valprev_ver4_acporc) as SOMA_valprev_ver4_acporc
    
        , SUM(valprev_ver5_acporc) as SOMA_valprev_ver5_acporc
    
        , SUM(valprev_ver6_acporc) as SOMA_valprev_ver6_acporc
    
        , SUM(valreal_calc_acporc) as SOMA_valreal_calc_acporc
    
        , SUM(valrsrv_calc_acporc) as SOMA_valrsrv_calc_acporc
    
    from TB_ACPORC
    group by MES_ACPORC 
)
    
select *
from vals

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:30:25.111670 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.04 seconds
[0m18:30:25.113749 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:30:25.113904 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes" rename to "soma_vals_por_mes__dbt_backup"
[0m18:30:25.114292 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:30:25.117036 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:30:25.117181 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
alter table "airbyte"."public"."soma_vals_por_mes__dbt_tmp" rename to "soma_vals_por_mes"
[0m18:30:25.117542 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:30:25.119293 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:30:25.119432 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:30:25.119555 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: COMMIT
[0m18:30:25.121349 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:30:25.122764 [debug] [Thread-4 (]: Using postgres connection "model.postgres_test.soma_vals_por_mes"
[0m18:30:25.122909 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.postgres_test.soma_vals_por_mes"} */
drop table if exists "airbyte"."public"."soma_vals_por_mes__dbt_backup" cascade
[0m18:30:25.125171 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:30:25.126068 [debug] [Thread-4 (]: finished collecting timing info
[0m18:30:25.126224 [debug] [Thread-4 (]: On model.postgres_test.soma_vals_por_mes: Close
[0m18:30:25.126802 [info ] [Thread-4 (]: 3 of 3 OK created table model public.soma_vals_por_mes ................................................................. [[32mSELECT 13[0m in 0.12s]
[0m18:30:25.127233 [debug] [Thread-4 (]: Finished running node model.postgres_test.soma_vals_por_mes
[0m18:30:25.128394 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:30:25.128562 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:25.128691 [debug] [MainThread]: On master: BEGIN
[0m18:30:25.128810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:30:25.130953 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:30:25.131236 [debug] [MainThread]: On master: COMMIT
[0m18:30:25.131428 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:25.131550 [debug] [MainThread]: On master: COMMIT
[0m18:30:25.131795 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:30:25.131958 [debug] [MainThread]: On master: Close
[0m18:30:25.132309 [info ] [MainThread]: 
[0m18:30:25.132600 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m18:30:25.132860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:25.132978 [debug] [MainThread]: Connection 'model.postgres_test.acporc' was properly closed.
[0m18:30:25.133133 [debug] [MainThread]: Connection 'model.postgres_test.dim_mes' was properly closed.
[0m18:30:25.133246 [debug] [MainThread]: Connection 'model.postgres_test.soma_vals_por_mes' was properly closed.
[0m18:30:25.137452 [info ] [MainThread]: 
[0m18:30:25.137749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:30:25.138007 [info ] [MainThread]: 
[0m18:30:25.138227 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
